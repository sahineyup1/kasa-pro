(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,24879,e=>{"use strict";var a=e.i(43476),s=e.i(71645),t=e.i(19455),l=e.i(93479),i=e.i(67489),r=e.i(84774),n=e.i(55146),d=e.i(69457),c=e.i(10204),o=e.i(24687),m=e.i(76639),x=e.i(77572),h=e.i(31278);let u=[{value:"admin",label:"Admin"},{value:"kasap",label:"Kasap"},{value:"kasiyer",label:"Kasiyer"},{value:"depo",label:"Depo"},{value:"depo_muduru",label:"Depo Muduru"},{value:"sofor",label:"Sofor"},{value:"finans",label:"Finans"}],p=[{value:"active",label:"Aktif"},{value:"inactive",label:"Pasif"},{value:"on_leave",label:"Izinli"},{value:"terminated",label:"Isten Ayrildi"}],y=["Merkez Depo","Atlas Mesnica","Desetka Market","Balkan Market"];function g({open:e,onOpenChange:r,employee:n,onSave:g}){let j=!!n,[v,b]=(0,s.useState)(""),[f,N]=(0,s.useState)(""),[S,k]=(0,s.useState)(""),[w,_]=(0,s.useState)(""),[T,C]=(0,s.useState)(""),[D,I]=(0,s.useState)(""),[M,$]=(0,s.useState)(""),[z,P]=(0,s.useState)("kasiyer"),[F,B]=(0,s.useState)(""),[O,L]=(0,s.useState)(""),[A,E]=(0,s.useState)(""),[K,R]=(0,s.useState)("active"),[V,H]=(0,s.useState)(""),[Y,G]=(0,s.useState)(""),[U,W]=(0,s.useState)(""),[Z,X]=(0,s.useState)(""),[q,J]=(0,s.useState)(""),[Q,ee]=(0,s.useState)(""),[ea,es]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(e){let e=new Date().toISOString().split("T")[0];if(n){let e=n.personal_info||n.personal||{},a=(e.full_name||"").split(" ");b(e.first_name||e.firstName||a[0]||n.firstName||""),N(e.last_name||e.lastName||a.slice(1).join(" ")||n.lastName||""),k(e.phone||n.phone||""),_(e.email||n.email||""),C(e.address||n.address||""),I(e.birth_date||e.dateOfBirth||n.dateOfBirth||""),$(e.nationality||n.nationality||"");let s=n.employment_info||n.employment||{};P(s.role||n.role||"kasiyer"),B(s.branch||n.branch||"");let t=n.salary_info||{};L(String(t.monthly_salary||s.salary||n.salary||"")||""),E(String(t.cash_salary||n.cashSalary||"")||""),R(n.status||s.status||"active"),H(s.start_date||s.startDate||n.startDate||"");let l=n.visa_info||n.documents||{},i=l.visa_expiry_date||l.visaExpiry||n.visaExpiry||"";G("9999-12-31"===i?"":i),W(l.work_permit_expiry||l.workPermitExpiry||n.workPermitExpiry||""),X(String(e.tc_no||l.nationalId||n.nationalId||"")),J(String(l.taxNumber||n.taxNumber||""));let r=n.notes;ee("string"==typeof r?r:"")}else b(""),N(""),k(""),_(""),C(""),I(""),$(""),P("kasiyer"),B(""),L(""),E(""),R("active"),H(e),G(""),W(""),X(""),J(""),ee("")}},[e,n]);let et=async()=>{if(!v.trim())return void alert("Lutfen isim girin!");if(!f.trim())return void alert("Lutfen soyisim girin!");if(!F)return void alert("Lutfen sube secin!");es(!0);try{let e={personal_info:{full_name:`${v.trim()} ${f.trim()}`.trim(),first_name:v.trim(),last_name:f.trim(),phone:S.trim(),email:w.trim(),address:T.trim(),birth_date:D,nationality:M.trim()},employment_info:{role:z,branch:F,position:z,start_date:V,status:K},salary_info:{monthly_salary:parseFloat(O)||0,cash_salary:parseFloat(A)||0,sgk_included:!0},visa_info:{visa_expiry_date:Y||"9999-12-31",work_permit_expiry:U||null,residence_type:Y?"Yıllık Vize":"Sürekli Vatandaş"},status:K,notes:(Q||"").toString().trim(),updatedAt:new Date().toISOString()};j&&n?.id?await (0,d.updateData)(`employees/${n.id}`,e):await (0,d.pushData)("employees",{...e,createdAt:new Date().toISOString()}),r(!1),g?.()}catch(e){console.error("Save error:",e),alert("Kaydetme hatasi: "+e.message)}finally{es(!1)}};return(0,a.jsx)(m.Dialog,{open:e,onOpenChange:r,children:(0,a.jsxs)(m.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)(m.DialogHeader,{className:"border-b pb-4",children:[(0,a.jsx)(m.DialogTitle,{className:"text-xl font-semibold",children:j?"Personel Duzenle":"Yeni Personel"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:j?"Personel bilgilerini guncelleyin":"Yeni personel eklemek icin formu doldurun"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto py-4",children:(0,a.jsxs)(x.Tabs,{defaultValue:"personal",className:"w-full",children:[(0,a.jsxs)(x.TabsList,{className:"grid w-full grid-cols-4 mb-4",children:[(0,a.jsx)(x.TabsTrigger,{value:"personal",children:"Kisisel"}),(0,a.jsx)(x.TabsTrigger,{value:"employment",children:"Istihdam"}),(0,a.jsx)(x.TabsTrigger,{value:"documents",children:"Belgeler"}),(0,a.jsx)(x.TabsTrigger,{value:"notes",children:"Notlar"})]}),(0,a.jsxs)(x.TabsContent,{value:"personal",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"firstName",children:"Isim *"}),(0,a.jsx)(l.Input,{id:"firstName",value:v,onChange:e=>b(e.target.value),placeholder:"Orn: Ahmet"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"lastName",children:"Soyisim *"}),(0,a.jsx)(l.Input,{id:"lastName",value:f,onChange:e=>N(e.target.value),placeholder:"Orn: Yilmaz"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"phone",children:"Telefon"}),(0,a.jsx)(l.Input,{id:"phone",value:S,onChange:e=>k(e.target.value),placeholder:"Orn: +386 40 123 456"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"email",children:"Email"}),(0,a.jsx)(l.Input,{id:"email",type:"email",value:w,onChange:e=>_(e.target.value),placeholder:"Orn: ahmet@example.com"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"dateOfBirth",children:"Dogum Tarihi"}),(0,a.jsx)(l.Input,{id:"dateOfBirth",type:"date",value:D,onChange:e=>I(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"nationality",children:"Uyruk"}),(0,a.jsx)(l.Input,{id:"nationality",value:M,onChange:e=>$(e.target.value),placeholder:"Orn: Turkiye"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"address",children:"Adres"}),(0,a.jsx)(o.Textarea,{id:"address",value:T,onChange:e=>C(e.target.value),placeholder:"Ikamet adresi...",rows:2})]})]}),(0,a.jsxs)(x.TabsContent,{value:"employment",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"role",children:"Rol *"}),(0,a.jsxs)(i.Select,{value:z,onValueChange:P,children:[(0,a.jsx)(i.SelectTrigger,{children:(0,a.jsx)(i.SelectValue,{placeholder:"Rol secin"})}),(0,a.jsx)(i.SelectContent,{children:u.map(e=>(0,a.jsx)(i.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"branch",children:"Sube *"}),(0,a.jsxs)(i.Select,{value:F,onValueChange:B,children:[(0,a.jsx)(i.SelectTrigger,{children:(0,a.jsx)(i.SelectValue,{placeholder:"Sube secin"})}),(0,a.jsx)(i.SelectContent,{children:y.map(e=>(0,a.jsx)(i.SelectItem,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-700 flex items-center gap-2",children:"Maas Bilgileri"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"bankSalary",className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:"text-amber-600",children:"Resmi Maas (Banka)"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:"€"}),(0,a.jsx)(l.Input,{id:"bankSalary",type:"number",step:"0.01",value:O,onChange:e=>L(e.target.value),placeholder:"0.00",className:"pl-8"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"SGK/vergi dahil resmi bordro maasi"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"cashSalary",className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:"text-green-600",children:"Elden Maas (Nakit)"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:"€"}),(0,a.jsx)(l.Input,{id:"cashSalary",type:"number",step:"0.01",value:A,onChange:e=>E(e.target.value),placeholder:"0.00",className:"pl-8"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Kayit disi elden odenen tutar"})]})]}),(parseFloat(O)>0||parseFloat(A)>0)&&(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Toplam Maas:"}),(0,a.jsxs)("span",{className:"font-semibold text-lg",children:["€",((parseFloat(O)||0)+(parseFloat(A)||0)).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),parseFloat(A)>0&&(0,a.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded p-2 text-sm text-amber-700",children:'Elden maas tanimli. Bu personelin elden odemesi "Toplu Maas Ode" ile yapilmaz, personel listesinden sag tik → "Elden Maas Ode" ile manuel odenir.'})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"status",children:"Durum"}),(0,a.jsxs)(i.Select,{value:K,onValueChange:R,children:[(0,a.jsx)(i.SelectTrigger,{children:(0,a.jsx)(i.SelectValue,{placeholder:"Durum secin"})}),(0,a.jsx)(i.SelectContent,{children:p.map(e=>(0,a.jsx)(i.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"startDate",children:"Ise Baslama Tarihi"}),(0,a.jsx)(l.Input,{id:"startDate",type:"date",value:V,onChange:e=>H(e.target.value),className:"w-[200px]"})]})]}),(0,a.jsxs)(x.TabsContent,{value:"documents",className:"space-y-4",children:[(0,a.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4",children:(0,a.jsxs)("p",{className:"text-sm text-amber-800",children:[(0,a.jsx)("strong",{children:"Onemli:"})," Vize ve calisma izni bitis tarihleri yaklastikca sistem sizi uyaracaktir."]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"visaExpiry",children:"Vize Bitis Tarihi"}),(0,a.jsx)(l.Input,{id:"visaExpiry",type:"date",value:Y,onChange:e=>G(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"workPermitExpiry",children:"Calisma Izni Bitis"}),(0,a.jsx)(l.Input,{id:"workPermitExpiry",type:"date",value:U,onChange:e=>W(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"nationalId",children:"Kimlik No"}),(0,a.jsx)(l.Input,{id:"nationalId",value:Z,onChange:e=>X(e.target.value),placeholder:"TC Kimlik / Pasaport No"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"taxNumber",children:"Vergi No"}),(0,a.jsx)(l.Input,{id:"taxNumber",value:q,onChange:e=>J(e.target.value),placeholder:"Vergi numarasi"})]})]})]}),(0,a.jsx)(x.TabsContent,{value:"notes",className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"notes",children:"Notlar"}),(0,a.jsx)(o.Textarea,{id:"notes",value:Q,onChange:e=>ee(e.target.value),placeholder:"Personel hakkinda ek notlar, ozel durumlar...",rows:8})]})})]})}),(0,a.jsxs)("div",{className:"border-t pt-4 flex justify-end gap-3",children:[(0,a.jsx)(t.Button,{variant:"outline",onClick:()=>r(!1),disabled:ea,children:"Iptal"}),(0,a.jsx)(t.Button,{onClick:et,disabled:ea,children:ea?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Kaydediliyor..."]}):"Personeli Kaydet"})]})]})})}let j=(0,e.i(75254).default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);var v=e.i(78583),b=e.i(21557),f=e.i(27612),N=e.i(7233);let S=[{id:"unpaid_leave",name:"Ucretsiz Izin",description:"Maastan tam kesinti yapilir",rate:0},{id:"annual_leave",name:"Yillik Izin",description:"Maas tam odenir",rate:1},{id:"sick_leave",name:"Hastalik Raporu (Bolniska)",description:"Ilk 30 gun %80, sonrasi ZZZS",rate:.8},{id:"work_accident",name:"Is Kazasi",description:"Tam maas odenir",rate:1}];function k({open:e,onOpenChange:r,employees:n}){let[x,h]=(0,s.useState)("new"),[u,p]=(0,s.useState)(!1),[y,g]=(0,s.useState)([]),[k,w]=(0,s.useState)(""),[_,T]=(0,s.useState)("unpaid_leave"),[C,D]=(0,s.useState)(""),[I,M]=(0,s.useState)(""),[$,z]=(0,s.useState)("");(0,s.useEffect)(()=>{if(!e)return;let a=(0,d.subscribeToData)("employee_leaves",e=>{e?g(Object.entries(e).map(([e,a])=>({id:e,...a})).filter(e=>"active"===e.status).sort((e,a)=>(a.startDate||"").localeCompare(e.startDate||""))):g([])});return()=>a()},[e]),(0,s.useEffect)(()=>{if(e){let e=new Date().toISOString().split("T")[0];D(e),M(e),w(""),T("unpaid_leave"),z("")}},[e]);let P=n.find(e=>e.id===k),F=e=>e.personal_info?.full_name||e.fullName||`${e.firstName||""} ${e.lastName||""}`.trim()||"Bilinmiyor",B=e=>e.salary_info?.monthly_salary||e.salary||0,O=()=>{if(!C||!I)return 0;let e=new Date(C);return Math.max(0,Math.ceil((new Date(I).getTime()-e.getTime())/864e5)+1)},{deduction:L,dailySalary:A,details:E}=(()=>{let e=O();if(!P||0===e)return{deduction:0,dailySalary:0,details:""};let a=B(P)/30;if(!S.find(e=>e.id===_))return{deduction:0,dailySalary:a,details:""};let s=0,t="";if("unpaid_leave"===_)s=a*e,t=`Gunluk maas: €${a.toFixed(2)} x ${e} gun = €${s.toFixed(2)} kesinti`;else if("annual_leave"===_)s=0,t="Yillik izin - kesinti yok, tam maas odenir";else if("sick_leave"===_){let l=.8*a*e;s=a*e-l,t=`Ilk 30 gun %80 odenir. Kesinti: €${s.toFixed(2)} (%20)`}else"work_accident"===_&&(s=0,t="Is kazasi - kesinti yok, tam maas odenir");return{deduction:s,dailySalary:a,details:t}})(),K=O(),R=async()=>{if(!k||!C||!I)return void alert("Lutfen tum alanlari doldurun");if(K<=0)return void alert("Bitis tarihi baslangic tarihinden once olamaz");p(!0);try{let e=S.find(e=>e.id===_),a=P?F(P):"",s={employeeId:k,employeeName:a,leaveType:_,leaveTypeName:e?.name||"",startDate:C,endDate:I,days:K,dailySalary:A,deduction:L,note:$.trim(),status:"active",createdAt:new Date().toISOString(),month:C.substring(0,7)};await (0,d.pushData)("employee_leaves",s),alert(`${a} icin ${K} gunluk izin/rapor kaydedildi.`),w(""),T("unpaid_leave"),z("");let t=new Date().toISOString().split("T")[0];D(t),M(t),h("list")}catch(e){console.error("Leave save error:",e),alert("Kayit hatasi: "+e.message)}finally{p(!1)}},V=async e=>{if(confirm("Bu izin/rapor kaydini silmek istediginize emin misiniz?"))try{await (0,d.updateData)(`employee_leaves/${e}`,{status:"deleted"})}catch(e){console.error("Delete error:",e),alert("Silme hatasi: "+e.message)}},H=e=>{if(!e)return"-";try{let a=new Date(e),s=a.getDate().toString().padStart(2,"0"),t=(a.getMonth()+1).toString().padStart(2,"0"),l=a.getFullYear();return`${s}.${t}.${l}`}catch{return e}};return(0,a.jsx)(m.Dialog,{open:e,onOpenChange:r,children:(0,a.jsxs)(m.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(m.DialogHeader,{children:[(0,a.jsxs)(m.DialogTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(j,{className:"h-5 w-5"}),"Izin/Rapor Yonetimi"]}),(0,a.jsx)(m.DialogDescription,{children:"Personel izin ve hastalik raporu yonetimi - Slovenya kanunlarina uygun hesaplama"})]}),(0,a.jsxs)("div",{className:"flex border-b mb-4",children:[(0,a.jsxs)("button",{className:`px-4 py-2 font-medium ${"new"===x?"border-b-2 border-amber-600 text-amber-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>h("new"),children:[(0,a.jsx)(N.Plus,{className:"h-4 w-4 inline mr-1"}),"Yeni Kayit"]}),(0,a.jsxs)("button",{className:`px-4 py-2 font-medium ${"list"===x?"border-b-2 border-amber-600 text-amber-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>h("list"),children:[(0,a.jsx)(v.FileText,{className:"h-4 w-4 inline mr-1"}),"Kayitlar (",y.length,")"]})]}),"new"===x?(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{children:"Personel"}),(0,a.jsxs)(i.Select,{value:k,onValueChange:w,children:[(0,a.jsx)(i.SelectTrigger,{children:(0,a.jsx)(i.SelectValue,{placeholder:"Personel secin"})}),(0,a.jsx)(i.SelectContent,{children:n.map(e=>(0,a.jsx)(i.SelectItem,{value:e.id,children:F(e)},e.id))})]}),P&&(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Aylik Maas: €",B(P).toLocaleString("tr-TR",{minimumFractionDigits:2})," | Gunluk: €",(B(P)/30).toFixed(2)]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{children:"Izin Turu"}),(0,a.jsx)("div",{className:"space-y-2",children:S.map(e=>(0,a.jsxs)("label",{className:`flex items-start p-3 border rounded-lg cursor-pointer transition-colors ${_===e.id?"border-amber-500 bg-amber-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,a.jsx)("input",{type:"radio",name:"leaveType",value:e.id,checked:_===e.id,onChange:e=>T(e.target.value),className:"mt-1 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]},e.id))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{children:"Baslangic Tarihi"}),(0,a.jsx)(l.Input,{type:"date",value:C,onChange:e=>D(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{children:"Bitis Tarihi"}),(0,a.jsx)(l.Input,{type:"date",value:I,onChange:e=>M(e.target.value)})]})]}),K>0&&(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)("span",{className:"px-4 py-2 bg-amber-600 text-white rounded-lg font-medium",children:[K," gun"]})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{children:"Aciklama (Opsiyonel)"}),(0,a.jsx)(o.Textarea,{value:$,onChange:e=>z(e.target.value),placeholder:"Izin/rapor hakkinda not...",rows:3})]}),(0,a.jsxs)("div",{className:"p-4 bg-amber-50 border-2 border-amber-200 rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-medium text-amber-800 mb-3 flex items-center gap-2",children:[(0,a.jsx)(b.Calculator,{className:"h-4 w-4"}),"Maas Hesaplamasi"]}),P&&K>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-sm text-gray-700 space-y-1 mb-3",children:[(0,a.jsxs)("p",{children:["Gunluk maas: €",A.toFixed(2)]}),(0,a.jsxs)("p",{children:["Izin gunu: ",K," gun"]}),(0,a.jsx)("p",{children:E})]}),(0,a.jsx)("div",{className:`text-lg font-bold pt-3 border-t border-amber-200 ${L>0?"text-red-600":"text-green-600"}`,children:L>0?`Kesinti: -€${L.toFixed(2)}`:"Kesinti: €0.00 (Tam maas)"})]}):(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Hesaplama icin personel secin ve tarihleri girin"})]})]})]}):(0,a.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:0===y.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Henuz izin/rapor kaydi yok"}):(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 sticky top-0",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Personel"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Tur"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Tarih"}),(0,a.jsx)("th",{className:"px-4 py-2 text-center text-sm font-medium text-gray-700",children:"Gun"}),(0,a.jsx)("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-700",children:"Kesinti"}),(0,a.jsx)("th",{className:"px-4 py-2 text-center text-sm font-medium text-gray-700",children:"Islem"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:y.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-sm",children:e.employeeName}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm",children:e.leaveTypeName}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm",children:[H(e.startDate)," - ",H(e.endDate)]}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-center",children:e.days}),(0,a.jsx)("td",{className:`px-4 py-3 text-sm text-right font-medium ${e.deduction>0?"text-red-600":"text-green-600"}`,children:e.deduction>0?`-€${e.deduction.toFixed(2)}`:"€0.00"}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:(0,a.jsx)(t.Button,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>V(e.id),children:(0,a.jsx)(f.Trash2,{className:"h-4 w-4"})})})]},e.id))})]})}),(0,a.jsxs)(m.DialogFooter,{children:[(0,a.jsx)(t.Button,{variant:"outline",onClick:()=>r(!1),children:"Kapat"}),"new"===x&&(0,a.jsx)(t.Button,{onClick:R,disabled:u||!k||K<=0,children:u?"Kaydediliyor...":"Kaydet"})]})]})})}var w=e.i(57428),_=e.i(7486),T=e.i(61911),C=e.i(78894),D=e.i(95468),I=e.i(73884),M=e.i(87378);function $({open:e,onOpenChange:i,employees:r}){let[n,o]=(0,s.useState)(!1),[x,h]=(0,s.useState)(""),[u,p]=(0,s.useState)([]),[y,g]=(0,s.useState)([]),[j,v]=(0,s.useState)([]),b=(0,s.useMemo)(()=>{let e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},[]),f=(0,s.useMemo)(()=>new Date().toLocaleDateString("tr-TR",{month:"long",year:"numeric"}),[]);(0,s.useEffect)(()=>{if(!e)return;let a=(0,d.subscribeToData)("employee_leaves",e=>{e?g(Object.entries(e).map(([e,a])=>({id:e,...a})).filter(e=>"active"===e.status&&e.month===b)):g([])}),s=(0,d.subscribeToData)("salary_payments",e=>{e?v(Object.entries(e).map(([e,a])=>({id:e,...a})).filter(e=>e.month===b&&"paid"===e.status&&"bank"===e.paymentType)):v([])});return()=>{a(),s()}},[e,b]),(0,s.useEffect)(()=>{if(!e)return;h(new Date().toISOString().split("T")[0]);let a=r.filter(e=>{let a=e.status||"active";return"active"===a||"aktif"===a}).map(e=>{let a=e.personal_info?.full_name||e.fullName||`${e.firstName||""} ${e.lastName||""}`.trim()||"Bilinmiyor",s=e.employment_info?.position||e.employment_info?.role||"",t=e.salary_info?.monthly_salary||e.salary||0,l=e.salary_info?.cash_salary||e.cashSalary||0,i=e.salary_info?.lastPaymentMonth||null,r=j.some(a=>a.employeeId===e.id),n=y.filter(a=>a.employeeId===e.id),d=n.reduce((e,a)=>e+(a.deduction||0),0),c=n.reduce((e,a)=>e+(a.days||0),0),o=Math.max(0,t-d);return{id:e.id,name:a,position:s,bankSalary:t,cashSalary:l,deduction:d,leaveDays:c,netBankSalary:o,selected:!r&&t>0,bankAmount:o,isPaid:r,lastPaymentMonth:i}});a.sort((e,a)=>e.isPaid===a.isPaid?e.name.localeCompare(a.name):e.isPaid?1:-1),p(a)},[e,r,y,j]);let N=(0,s.useMemo)(()=>{let e=u.filter(e=>e.selected&&!e.isPaid),a=u.filter(e=>!e.isPaid&&e.bankSalary>0),s=u.filter(e=>e.isPaid),t=u.filter(e=>e.cashSalary>0&&!e.isPaid);return{selectedCount:e.length,unpaidCount:a.length,paidCount:s.length,withCashCount:t.length,bankTotal:e.reduce((e,a)=>e+a.bankAmount,0),deductionTotal:e.reduce((e,a)=>e+a.deduction,0),totalCashPending:t.reduce((e,a)=>e+a.cashSalary,0)}},[u]),S=async()=>{let e=u.filter(e=>e.selected&&!e.isPaid&&e.bankAmount>0);if(0===e.length)return void alert("Odeme yapilacak personel seciniz");if(!confirm(`${e.length} personele toplam €${N.bankTotal.toLocaleString("tr-TR",{minimumFractionDigits:2})} BANKA odemesi yapilacak.

Onayliyor musunuz?`))return;o(!0);let a=0,s=[];for(let t of e)try{let e={employeeId:t.id,employeeName:t.name,amount:t.bankAmount,grossAmount:t.bankSalary,deduction:t.deduction,paymentDate:x,paymentType:"bank",paymentMethod:"bank_transfer",type:"salary",status:"paid",createdAt:new Date().toISOString(),month:b};await (0,d.pushData)("salary_payments",e),await (0,d.updateData)(`employees/${t.id}/salary_info`,{lastPaymentDate:x,lastPaymentMonth:b,lastBankPayment:t.bankAmount}),a++}catch(e){console.error(`Payment error for ${t.name}:`,e),s.push(`${t.name}: ${e.message}`)}o(!1),s.length>0?alert(`${a} odeme basarili, ${s.length} basarisiz.

Hatalar:
${s.join("\n")}`):(alert(`${a} personele banka maaş odemesi yapildi!`),i(!1))},k=e=>`€${e.toLocaleString("tr-TR",{minimumFractionDigits:2})}`;return(0,a.jsx)(m.Dialog,{open:e,onOpenChange:i,children:(0,a.jsxs)(m.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)(m.DialogHeader,{className:"bg-amber-600 -m-6 mb-0 p-6 rounded-t-lg",children:[(0,a.jsxs)(m.DialogTitle,{className:"flex items-center gap-2 text-white text-xl",children:[(0,a.jsx)(_.Building2,{className:"h-6 w-6"}),"Toplu Banka Maaş Odemesi"]}),(0,a.jsxs)(m.DialogDescription,{className:"text-amber-100",children:[f," - Sadece resmi (banka) maaslari"]})]}),N.withCashCount>0&&(0,a.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-center gap-3",children:[(0,a.jsx)(M.Banknote,{className:"h-5 w-5 text-amber-600"}),(0,a.jsxs)("div",{className:"text-sm text-amber-800",children:[(0,a.jsxs)("strong",{children:[N.withCashCount," personelin"]})," elden maaşı var (toplam ",k(N.totalCashPending),'). Elden ödemeler için personel listesinde sağ tık → "Elden Maaş Öde" kullanın.']})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6 py-3 border-b",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.Label,{className:"text-sm text-gray-600",children:"Odeme Tarihi:"}),(0,a.jsx)(l.Input,{type:"date",value:x,onChange:e=>h(e.target.value),className:"w-40"})]}),(0,a.jsx)("div",{className:"flex-1"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1 text-green-600",children:[(0,a.jsx)(D.CheckCircle2,{className:"h-4 w-4"})," ",N.paidCount," odendi"]}),(0,a.jsx)("span",{className:"text-gray-300",children:"|"}),(0,a.jsxs)("span",{className:"flex items-center gap-1 text-orange-600",children:[(0,a.jsx)(I.XCircle,{className:"h-4 w-4"})," ",N.unpaidCount," bekliyor"]})]}),(0,a.jsx)(t.Button,{variant:"outline",size:"sm",onClick:()=>{p(e=>e.map(e=>({...e,selected:!e.isPaid&&e.bankSalary>0})))},children:"Odenmemisleri Sec"}),(0,a.jsx)(t.Button,{variant:"outline",size:"sm",onClick:()=>{p(e=>e.map(e=>({...e,selected:!1})))},children:"Secimi Kaldir"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto py-4 space-y-2",children:u.map(e=>(0,a.jsx)("div",{className:`border rounded-lg p-3 transition-all ${e.isPaid?"border-green-200 bg-green-50":e.selected?"border-amber-300 bg-white":"border-gray-200 bg-gray-50 opacity-60"}`,children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[e.isPaid?(0,a.jsx)(D.CheckCircle2,{className:"h-5 w-5 text-green-600"}):(0,a.jsx)(w.Checkbox,{checked:e.selected,onCheckedChange:()=>{var a;return a=e.id,void p(e=>e.map(e=>e.id!==a||e.isPaid?e:{...e,selected:!e.selected}))},disabled:0===e.bankSalary}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:`font-medium ${e.isPaid?"text-green-800":"text-gray-900"}`,children:e.name}),e.position&&(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.position}),e.isPaid&&(0,a.jsx)("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full",children:"Bu ay odendi"}),e.cashSalary>0&&!e.isPaid&&(0,a.jsxs)("span",{className:"text-xs bg-amber-100 text-amber-700 px-2 py-0.5 rounded-full flex items-center gap-1",children:[(0,a.jsx)(M.Banknote,{className:"h-3 w-3"}),"Elden: ",k(e.cashSalary)]})]}),e.deduction>0&&!e.isPaid&&(0,a.jsxs)("div",{className:"mt-1 flex items-center gap-1 text-amber-600 text-sm",children:[(0,a.jsx)(C.AlertTriangle,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[e.leaveDays," gun izin - Kesinti: ",k(e.deduction)]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Banka Maasi"}),e.deduction>0&&!e.isPaid?(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-gray-400 line-through mr-2",children:k(e.bankSalary)}),(0,a.jsx)("span",{className:"font-semibold text-amber-600",children:k(e.netBankSalary)})]}):(0,a.jsx)("div",{className:"font-semibold text-amber-600",children:k(e.bankSalary)})]}),!e.isPaid&&e.bankSalary>0&&(0,a.jsx)("div",{className:"w-32",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"€"}),(0,a.jsx)(l.Input,{type:"number",value:e.bankAmount,onChange:a=>{var s,t;return s=e.id,t=parseFloat(a.target.value)||0,void p(e=>e.map(e=>e.id===s?{...e,bankAmount:t}:e))},className:"pl-6 text-right font-medium h-9",disabled:!e.selected})]})})]})]})},e.id))}),(0,a.jsx)("div",{className:"border-t pt-4 -mx-6 px-6 bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,a.jsx)(T.Users,{className:"h-5 w-5"}),(0,a.jsxs)("span",{className:"font-medium",children:[N.selectedCount," personel secili"]})]}),N.deductionTotal>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-amber-600",children:[(0,a.jsx)(C.AlertTriangle,{className:"h-5 w-5"}),(0,a.jsxs)("span",{children:["Kesinti: ",k(N.deductionTotal)]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Toplam Banka Odemesi"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:k(N.bankTotal)})]}),(0,a.jsx)(t.Button,{variant:"outline",onClick:()=>i(!1),children:"Iptal"}),(0,a.jsxs)(t.Button,{onClick:S,disabled:n||0===N.selectedCount,className:"bg-amber-600 hover:bg-amber-700",children:[(0,a.jsx)(_.Building2,{className:"h-4 w-4 mr-2"}),n?"Isleniyor...":"Banka Odemelerini Yap"]})]})]})})]})})}var z=e.i(16715),P=e.i(41071),F=e.i(88699),B=e.i(86536),O=e.i(55436),L=e.i(82293),A=e.i(52754),E=e.i(87316);let K={admin:"Admin",kasap:"Kasap",kasiyer:"Kasiyer",depo:"Depo",depo_muduru:"Depo Muduru",sofor:"Sofor",finans:"Finans"};function R({status:e}){return(0,a.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${{active:"bg-green-100 text-green-800",aktif:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-600",pasif:"bg-gray-100 text-gray-600",on_leave:"bg-amber-100 text-amber-800",izinli:"bg-amber-100 text-amber-800",terminated:"bg-red-100 text-red-800",isten_ayrildi:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-600"}`,children:{active:"Aktif",aktif:"Aktif",inactive:"Pasif",pasif:"Pasif",on_leave:"Izinli",izinli:"Izinli",terminated:"Ayrildi",isten_ayrildi:"Ayrildi"}[e]||e})}function V({expiryDate:e}){if(!e)return(0,a.jsx)("span",{className:"text-gray-400",children:"-"});if("9999-12-31"===e||e.startsWith("9999"))return(0,a.jsx)("span",{className:"text-green-600 font-medium",children:"Suresiz"});let s=new Date(e),t=new Date,l=Math.ceil((s.getTime()-t.getTime())/864e5);return l<0?(0,a.jsx)("span",{className:"text-red-600 font-medium",children:"Suresi doldu!"}):l<=30?(0,a.jsxs)("span",{className:"text-amber-600 font-medium",children:[l," gun kaldi"]}):l<=90?(0,a.jsxs)("span",{className:"text-yellow-600",children:[l," gun"]}):(0,a.jsx)("span",{className:"text-gray-600",children:function(e){if(!e)return"-";try{let a=new Date(e),s=a.getDate().toString().padStart(2,"0"),t=(a.getMonth()+1).toString().padStart(2,"0"),l=a.getFullYear();return`${s}.${t}.${l}`}catch{return e}}(e)})}function H(e,a,s,t){let l=e;for(let e of a)if(l&&"object"==typeof l&&e in l)l=l[e];else{l=void 0;break}if(null!=l)return l;let i=e[s];return null!=i?i:t}function Y(){let[e,c]=(0,s.useState)([]),[o,m]=(0,s.useState)(!0),[x,h]=(0,s.useState)(""),[u,p]=(0,s.useState)("all"),[y,j]=(0,s.useState)("all"),[b,S]=(0,s.useState)("all"),[w,_]=(0,s.useState)(!1),[D,I]=(0,s.useState)(null),[Y,G]=(0,s.useState)(!1),[U,W]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{m(!0);try{let e=await (0,d.getDataArray)("employees");if(e&&e.length>0){let a=e.map(e=>{let a=e.personal_info?.full_name||"",s=a.split(" "),t=e.personal_info?.first_name||s[0]||e.firstName||"",l=e.personal_info?.last_name||s.slice(1).join(" ")||e.lastName||"";return{id:e.id,...e,firstName:t,lastName:l,fullName:a,role:e.employment_info?.role||e.role||"",branch:e.employment_info?.branch||e.branch||"",branchId:e.employment_info?.branch_id||e.branchId||"",position:e.employment_info?.position||e.position||"",phone:e.personal_info?.phone||e.phone||"",email:e.personal_info?.email||e.email||"",salary:e.salary_info?.monthly_salary||e.salary||0,cashSalary:e.salary_info?.cash_salary||0,sgkIncluded:e.salary_info?.sgk_included||!1,status:e.status||e.employment_info?.status||"active",startDate:e.employment_info?.start_date||e.startDate||"",visaExpiry:e.visa_info?.visa_expiry_date||e.documents?.visa_expiry_date||e.visaExpiry||"",residenceType:e.visa_info?.residence_type||"",documentExpiry:e.visa_info?.document_expiry_date||e.documents?.document_expiry_date||e.documentExpiry||"",notes:e.notes||"",personal:{firstName:t,lastName:l,fullName:a,phone:e.personal_info?.phone||e.phone||"",email:e.personal_info?.email||e.email||""},employment:{role:e.employment_info?.role||e.role||"",branch:e.employment_info?.branch||e.branch||"",branchId:e.employment_info?.branch_id||e.branchId||"",position:e.employment_info?.position||e.position||"",salary:e.salary_info?.monthly_salary||e.salary||0,status:e.status||e.employment_info?.status||"active",startDate:e.employment_info?.start_date||e.startDate||""},documents:{visaExpiry:e.visa_info?.visa_expiry_date||e.documents?.visa_expiry_date||e.visaExpiry||"",documentExpiry:e.visa_info?.document_expiry_date||e.documents?.document_expiry_date||e.documentExpiry||""}}});c(a)}else c([])}catch(e){console.error("Employees load error:",e),c([])}finally{m(!1)}})()},[]);let Z=(0,s.useMemo)(()=>e.filter(e=>{let a=H(e,["personal","firstName"],"firstName",""),s=H(e,["personal","lastName"],"lastName",""),t=`${a} ${s}`.toLowerCase(),l=H(e,["personal","phone"],"phone",""),i=H(e,["personal","email"],"email",""),r=x.toLowerCase(),n=!x||t.includes(r)||l.includes(r)||i.toLowerCase().includes(r),d=H(e,["employment","role"],"role",""),c="all"===u||d===u,o=H(e,["employment","status"],"status","active"),m="all"===y||o===y,h=H(e,["employment","branch"],"branch",""),p="all"===b||h===b;return n&&c&&m&&p}),[e,x,u,y,b]),X=(0,s.useMemo)(()=>{let a=e.length,s=e.filter(e=>{let a=H(e,["employment","status"],"status","active");return"active"===a||"aktif"===a}).length;return{total:a,active:s,visaWarning:e.filter(e=>{let a=H(e,["documents","visaExpiry"],"visaExpiry",null);if(!a)return!1;let s=new Date(a),t=new Date;return 30>=Math.ceil((s.getTime()-t.getTime())/864e5)}).length,totalSalary:e.reduce((e,a)=>{let s=H(a,["employment","status"],"status","active");return"active"===s||"aktif"===s?e+H(a,["employment","salary"],"salary",0):e},0)}},[e]),q=(0,s.useMemo)(()=>{let a=new Set;return e.forEach(e=>{let s=H(e,["employment","branch"],"branch","");s&&a.add(s)}),Array.from(a).sort()},[e]),J=(0,s.useMemo)(()=>{let a=new Set;return e.forEach(e=>{let s=H(e,["employment","role"],"role","");s&&a.add(s)}),Array.from(a).sort()},[e]),Q=async e=>{try{let a=e.status||H(e,["employment","status"],"status","active"),s="active"===a||"aktif"===a?"inactive":"active";await (0,d.updateData)(`employees/${e.id}`,{status:s,"employment_info/status":s,updatedAt:new Date().toISOString()})}catch(e){console.error("Status update error:",e),alert("Durum guncellenemedi: "+e.message)}},ee=async e=>{let a=e.fullName||`${e.firstName} ${e.lastName}`.trim()||"Personel";if(confirm(`"${a}" personelini silmek istediginize emin misiniz?`))try{await (0,d.removeData)(`employees/${e.id}`)}catch(e){console.error("Delete error:",e),alert("Silme hatasi: "+e.message)}},ea=async e=>{let a=e.fullName||`${e.firstName} ${e.lastName}`.trim()||"Personel",s=e.salary_info?.cash_salary||e.cashSalary||0;if(s<=0)return void alert("Bu personelin elden maasi tanimli degil!");let t=prompt(`${a} icin elden odeme tutari:

Tanimli elden maas: €${s.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,String(s));if(!t)return;let l=parseFloat(t);if(isNaN(l)||l<=0)return void alert("Gecersiz tutar!");if(confirm(`${a}'e €${l.toLocaleString("tr-TR",{minimumFractionDigits:2})} elden odeme yapilacak. Onayliyor musunuz?`))try{let t=new Date().toISOString().substring(0,7),i=new Date().toISOString().split("T")[0],r={employeeId:e.id,employeeName:a,amount:l,grossAmount:s,paymentDate:i,paymentType:"cash",paymentMethod:"cash",type:"salary",status:"paid",createdAt:new Date().toISOString(),month:t};await (0,d.pushData)("salary_payments",r),await (0,d.updateData)(`employees/${e.id}/salary_info`,{lastCashPaymentDate:i,lastCashPaymentMonth:t,lastCashPayment:l}),alert(`${a}'e €${l.toLocaleString("tr-TR",{minimumFractionDigits:2})} elden odeme yapildi!`)}catch(e){console.error("Cash payment error:",e),alert("Odeme hatasi: "+e.message)}};return(0,a.jsxs)("div",{className:"h-full flex flex-col bg-gray-50",children:[(0,a.jsxs)("div",{className:"bg-white border-b px-8 py-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Personel Yonetimi"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Calisan bilgileri, vize takibi ve maas yonetimi"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(t.Button,{variant:"outline",size:"sm",onClick:()=>{m(!0),setTimeout(()=>m(!1),500)},disabled:o,children:[(0,a.jsx)(z.RefreshCw,{className:`h-4 w-4 mr-2 ${o?"animate-spin":""}`}),"Yenile"]}),(0,a.jsxs)(t.Button,{variant:"outline",size:"sm",onClick:()=>G(!0),children:[(0,a.jsx)(E.Calendar,{className:"h-4 w-4 mr-2"}),"Izin/Rapor"]}),(0,a.jsxs)(t.Button,{variant:"outline",size:"sm",className:"bg-green-600 hover:bg-green-700 text-white border-0",onClick:()=>W(!0),children:[(0,a.jsx)(A.Wallet,{className:"h-4 w-4 mr-2"}),"Toplu Maas Ode"]}),(0,a.jsxs)(t.Button,{onClick:()=>{I(null),_(!0)},children:[(0,a.jsx)(N.Plus,{className:"h-4 w-4 mr-2"}),"Yeni Personel"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,a.jsx)("div",{className:"bg-amber-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-amber-100 rounded-lg",children:(0,a.jsx)(T.Users,{className:"h-5 w-5 text-amber-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Toplam Personel"}),(0,a.jsx)("p",{className:"text-xl font-semibold text-gray-900",children:X.total})]})]})}),(0,a.jsx)("div",{className:"bg-green-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(L.UserCheck,{className:"h-5 w-5 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Aktif Calisan"}),(0,a.jsx)("p",{className:"text-xl font-semibold text-gray-900",children:X.active})]})]})}),(0,a.jsx)("div",{className:"bg-amber-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-amber-100 rounded-lg",children:(0,a.jsx)(C.AlertTriangle,{className:"h-5 w-5 text-amber-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Vize Uyarisi"}),(0,a.jsx)("p",{className:"text-xl font-semibold text-amber-600",children:X.visaWarning})]})]})}),(0,a.jsx)("div",{className:"bg-purple-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)(A.Wallet,{className:"h-5 w-5 text-purple-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Toplam Maas"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-gray-900",children:["€",X.totalSalary.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(O.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)(l.Input,{placeholder:"Personel ara...",value:x,onChange:e=>h(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(i.Select,{value:b,onValueChange:S,children:[(0,a.jsx)(i.SelectTrigger,{className:"w-[180px]",children:(0,a.jsx)(i.SelectValue,{placeholder:"Sube"})}),(0,a.jsxs)(i.SelectContent,{children:[(0,a.jsx)(i.SelectItem,{value:"all",children:"Tum Subeler"}),q.map(e=>(0,a.jsx)(i.SelectItem,{value:e,children:e},e))]})]}),(0,a.jsxs)(i.Select,{value:u,onValueChange:p,children:[(0,a.jsx)(i.SelectTrigger,{className:"w-[150px]",children:(0,a.jsx)(i.SelectValue,{placeholder:"Rol"})}),(0,a.jsxs)(i.SelectContent,{children:[(0,a.jsx)(i.SelectItem,{value:"all",children:"Tum Roller"}),J.map(e=>(0,a.jsx)(i.SelectItem,{value:e,children:K[e]||e},e))]})]}),(0,a.jsxs)(i.Select,{value:y,onValueChange:j,children:[(0,a.jsx)(i.SelectTrigger,{className:"w-[150px]",children:(0,a.jsx)(i.SelectValue,{placeholder:"Durum"})}),(0,a.jsxs)(i.SelectContent,{children:[(0,a.jsx)(i.SelectItem,{value:"all",children:"Tum durumlar"}),(0,a.jsx)(i.SelectItem,{value:"active",children:"Aktif"}),(0,a.jsx)(i.SelectItem,{value:"inactive",children:"Pasif"}),(0,a.jsx)(i.SelectItem,{value:"on_leave",children:"Izinli"})]})]})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto p-8",children:(0,a.jsx)("div",{className:"bg-white rounded-lg border",children:(0,a.jsxs)(r.Table,{children:[(0,a.jsx)(r.TableHeader,{children:(0,a.jsxs)(r.TableRow,{children:[(0,a.jsx)(r.TableHead,{children:"Personel"}),(0,a.jsx)(r.TableHead,{children:"Rol"}),(0,a.jsx)(r.TableHead,{children:"Sube"}),(0,a.jsx)(r.TableHead,{children:"Telefon"}),(0,a.jsx)(r.TableHead,{className:"text-right",children:"Maas"}),(0,a.jsx)(r.TableHead,{children:"Vize/Izin"}),(0,a.jsx)(r.TableHead,{children:"Durum"}),(0,a.jsx)(r.TableHead,{className:"w-[60px]"})]})}),(0,a.jsx)(r.TableBody,{children:o?(0,a.jsx)(r.TableRow,{children:(0,a.jsx)(r.TableCell,{colSpan:8,className:"text-center py-8 text-gray-500",children:"Yukleniyor..."})}):0===Z.length?(0,a.jsx)(r.TableRow,{children:(0,a.jsx)(r.TableCell,{colSpan:8,className:"text-center py-8 text-gray-500",children:x||"all"!==u||"all"!==y||"all"!==b?"Filtrelere uygun personel bulunamadi":"Henuz personel eklenmemis"})}):Z.map(e=>{let s=e.fullName||H(e,["personal","fullName"],"fullName","")||`${H(e,["personal","firstName"],"firstName","")} ${H(e,["personal","lastName"],"lastName","")}`.trim()||"Bilinmiyor",l=e.firstName||H(e,["personal","firstName"],"firstName",s.split(" ")[0]||""),i=e.lastName||H(e,["personal","lastName"],"lastName",s.split(" ").slice(1).join(" ")||""),d=e.role||H(e,["employment","role"],"role","-"),c=e.branch||H(e,["employment","branch"],"branch","-"),o=e.phone||H(e,["personal","phone"],"phone","-"),m=e.email||H(e,["personal","email"],"email",""),x=e.salary||H(e,["employment","salary"],"salary",0),h=e.status||H(e,["employment","status"],"status","active"),u=e.visaExpiry||H(e,["documents","visaExpiry"],"visaExpiry",null);return(0,a.jsxs)(r.TableRow,{className:"hover:bg-gray-50",children:[(0,a.jsx)(r.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"h-10 w-10 rounded-full bg-amber-100 flex items-center justify-center text-amber-600 font-medium",children:[l.charAt(0),i.charAt(0)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:s}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:m})]})]})}),(0,a.jsx)(r.TableCell,{className:"text-gray-600",children:K[d]||d}),(0,a.jsx)(r.TableCell,{className:"text-gray-600",children:c}),(0,a.jsx)(r.TableCell,{className:"text-gray-600",children:o}),(0,a.jsxs)(r.TableCell,{className:"text-right font-medium",children:["€",x.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsx)(r.TableCell,{children:(0,a.jsx)(V,{expiryDate:u})}),(0,a.jsx)(r.TableCell,{children:(0,a.jsx)(R,{status:h})}),(0,a.jsx)(r.TableCell,{children:(0,a.jsxs)(n.DropdownMenu,{children:[(0,a.jsx)(n.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(t.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(P.MoreHorizontal,{className:"h-4 w-4"})})}),(0,a.jsxs)(n.DropdownMenuContent,{align:"end",children:[(0,a.jsxs)(n.DropdownMenuItem,{onClick:()=>{I(e),_(!0)},children:[(0,a.jsx)(B.Eye,{className:"h-4 w-4 mr-2"}),"Detaylari Goruntule"]}),(0,a.jsxs)(n.DropdownMenuItem,{onClick:()=>{I(e),_(!0)},children:[(0,a.jsx)(F.Pencil,{className:"h-4 w-4 mr-2"}),"Duzenle"]}),(0,a.jsxs)(n.DropdownMenuItem,{children:[(0,a.jsx)(v.FileText,{className:"h-4 w-4 mr-2"}),"Maas Gecmisi"]}),(0,a.jsx)(n.DropdownMenuSeparator,{}),(0,a.jsxs)(n.DropdownMenuItem,{onClick:()=>ea(e),className:"text-green-600",children:[(0,a.jsx)(M.Banknote,{className:"h-4 w-4 mr-2"}),"Elden Maas Ode"]}),(0,a.jsx)(n.DropdownMenuSeparator,{}),(0,a.jsx)(n.DropdownMenuItem,{onClick:()=>Q(e),children:"active"===h||"aktif"===h?"⏸️ Pasif Yap":"▶️ Aktif Yap"}),(0,a.jsx)(n.DropdownMenuSeparator,{}),(0,a.jsxs)(n.DropdownMenuItem,{onClick:()=>ee(e),className:"text-red-600",children:[(0,a.jsx)(f.Trash2,{className:"h-4 w-4 mr-2"}),"Sil"]})]})]})})]},e.id)})})]})})}),(0,a.jsx)(g,{open:w,onOpenChange:_,employee:D,onSave:()=>_(!1)}),(0,a.jsx)(k,{open:Y,onOpenChange:G,employees:e}),(0,a.jsx)($,{open:U,onOpenChange:W,employees:e})]})}e.s(["default",()=>Y],24879)}]);