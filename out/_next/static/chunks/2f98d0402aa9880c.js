(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,57820,e=>{"use strict";var a=e.i(43476),s=e.i(71645),t=e.i(19455),l=e.i(93479),i=e.i(10204),r=e.i(67489),n=e.i(81140),c=e.i(20783),d=e.i(30030),m=e.i(69340),o=e.i(99682),x=e.i(35804),h=e.i(48425),u="Switch",[g,p]=(0,d.createContextScope)(u),[j,b]=g(u),N=s.forwardRef((e,t)=>{let{__scopeSwitch:l,name:i,checked:r,defaultChecked:d,required:o,disabled:x,value:g="on",onCheckedChange:p,form:b,...N}=e,[v,y]=s.useState(null),k=(0,c.useComposedRefs)(t,e=>y(e)),S=s.useRef(!1),w=!v||b||!!v.closest("form"),[D,C]=(0,m.useControllableState)({prop:r,defaultProp:d??!1,onChange:p,caller:u});return(0,a.jsxs)(j,{scope:l,checked:D,disabled:x,children:[(0,a.jsx)(h.Primitive.button,{type:"button",role:"switch","aria-checked":D,"aria-required":o,"data-state":T(D),"data-disabled":x?"":void 0,disabled:x,value:g,...N,ref:k,onClick:(0,n.composeEventHandlers)(e.onClick,e=>{C(e=>!e),w&&(S.current=e.isPropagationStopped(),S.current||e.stopPropagation())})}),w&&(0,a.jsx)(f,{control:v,bubbles:!S.current,name:i,value:g,checked:D,required:o,disabled:x,form:b,style:{transform:"translateX(-100%)"}})]})});N.displayName=u;var v="SwitchThumb",y=s.forwardRef((e,s)=>{let{__scopeSwitch:t,...l}=e,i=b(v,t);return(0,a.jsx)(h.Primitive.span,{"data-state":T(i.checked),"data-disabled":i.disabled?"":void 0,...l,ref:s})});y.displayName=v;var f=s.forwardRef(({__scopeSwitch:e,control:t,checked:l,bubbles:i=!0,...r},n)=>{let d=s.useRef(null),m=(0,c.useComposedRefs)(d,n),h=(0,o.usePrevious)(l),u=(0,x.useSize)(t);return s.useEffect(()=>{let e=d.current;if(!e)return;let a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(h!==l&&a){let s=new Event("click",{bubbles:i});a.call(e,l),e.dispatchEvent(s)}},[h,l,i]),(0,a.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:l,...r,tabIndex:-1,ref:m,style:{...r.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function T(e){return e?"checked":"unchecked"}f.displayName="SwitchBubbleInput";var k=e.i(75157);let S=s.forwardRef(({className:e,...s},t)=>(0,a.jsx)(N,{className:(0,k.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:t,children:(0,a.jsx)(y,{className:(0,k.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));S.displayName=N.displayName;var w=e.i(77572),D=e.i(84774),C=e.i(55146),A=e.i(68148),I=e.i(69457),R=e.i(46696),B=e.i(7233),L=e.i(16715),F=e.i(41071),K=e.i(55436),V=e.i(40160),H=e.i(94918),M=e.i(52754),O=e.i(7486),E=e.i(61659),z=e.i(25652),$=e.i(12426),P=e.i(75254);let U=(0,P.default)("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),_=(0,P.default)("arrow-down-right",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);var G=e.i(86536),Y=e.i(88511),W=e.i(27612),X=e.i(21557),Z=e.i(63059);let q=(0,P.default)("piggy-bank",[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]]);var J=e.i(50627),Q=e.i(69638),ee=e.i(3116);let ea=(0,P.default)("file-down",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);var es=e.i(23945),et=e.i(70756);let el=(0,P.default)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);var ei=e.i(57086),er=e.i(1928),en=e.i(88844);let ec=(0,P.default)("coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);var ed=e.i(70016),em=e.i(78631),eo=e.i(76639);let ex=(0,P.default)("arrow-left-right",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),eh=["NLB d.d.","Nova KBM","SKB Banka","Addiko Bank","Unicredit Banka","Sparkasse","NKBM","Delavska Hranilnica","Ziraat Bankasi","Is Bankasi","Garanti BBVA","Yapi Kredi","Akbank","Diger"];function eu({open:e,onOpenChange:n,account:c}){let[d,m]=(0,s.useState)(!1),[o,x]=(0,s.useState)({name:"",bankName:"",iban:"",currency:"EUR",balance:0,branch:"",accountNumber:"",swiftCode:"",isActive:!0});(0,s.useEffect)(()=>{c?x({name:c.name||"",bankName:c.bankName||"",iban:c.iban||"",currency:c.currency||"EUR",balance:c.balance||0,branch:c.branch||"",accountNumber:c.accountNumber||"",swiftCode:c.swiftCode||"",isActive:!1!==c.isActive}):x({name:"",bankName:"",iban:"",currency:"EUR",balance:0,branch:"",accountNumber:"",swiftCode:"",isActive:!0})},[c,e]);let h=async e=>{if(e.preventDefault(),!o.name||!o.bankName||!o.iban)return void R.toast.error("Lutfen zorunlu alanlari doldurun");m(!0);try{c?.id?(await (0,I.updateFirestoreData)("bankAccounts",c.id,o),R.toast.success("Banka hesabi guncellendi")):(await (0,I.addFirestoreData)("bankAccounts",{...o,createdAt:new Date().toISOString()}),R.toast.success("Banka hesabi eklendi")),n(!1)}catch(e){R.toast.error("Islem basarisiz: "+e.message)}finally{m(!1)}};return(0,a.jsx)(eo.Dialog,{open:e,onOpenChange:n,children:(0,a.jsxs)(eo.DialogContent,{className:"max-w-lg",children:[(0,a.jsx)(eo.DialogHeader,{children:(0,a.jsxs)(eo.DialogTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(O.Building2,{className:"h-5 w-5"}),c?"Banka Hesabi Duzenle":"Yeni Banka Hesabi"]})}),(0,a.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Hesap Adi *"}),(0,a.jsx)(l.Input,{value:o.name,onChange:e=>x({...o,name:e.target.value}),placeholder:"Ornek: Ana Hesap"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Banka *"}),(0,a.jsxs)(r.Select,{value:o.bankName,onValueChange:e=>x({...o,bankName:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{placeholder:"Banka secin"})}),(0,a.jsx)(r.SelectContent,{children:eh.map(e=>(0,a.jsx)(r.SelectItem,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"IBAN *"}),(0,a.jsx)(l.Input,{value:o.iban,onChange:e=>x({...o,iban:e.target.value.toUpperCase()}),placeholder:"SI56 0000 0000 0000 000",maxLength:32})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Hesap No"}),(0,a.jsx)(l.Input,{value:o.accountNumber,onChange:e=>x({...o,accountNumber:e.target.value}),placeholder:"Hesap numarasi"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Sube"}),(0,a.jsx)(l.Input,{value:o.branch,onChange:e=>x({...o,branch:e.target.value}),placeholder:"Sube adi"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Para Birimi"}),(0,a.jsxs)(r.Select,{value:o.currency,onValueChange:e=>x({...o,currency:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{})}),(0,a.jsxs)(r.SelectContent,{children:[(0,a.jsx)(r.SelectItem,{value:"EUR",children:"EUR"}),(0,a.jsx)(r.SelectItem,{value:"USD",children:"USD"}),(0,a.jsx)(r.SelectItem,{value:"TRY",children:"TRY"}),(0,a.jsx)(r.SelectItem,{value:"GBP",children:"GBP"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Acilis Bakiyesi"}),(0,a.jsx)(l.Input,{type:"number",step:"0.01",value:o.balance,onChange:e=>x({...o,balance:parseFloat(e.target.value)||0})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"SWIFT Kodu"}),(0,a.jsx)(l.Input,{value:o.swiftCode,onChange:e=>x({...o,swiftCode:e.target.value.toUpperCase()}),placeholder:"XXXXXXXX"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,a.jsx)(t.Button,{type:"button",variant:"outline",onClick:()=>n(!1),disabled:d,children:"Iptal"}),(0,a.jsx)(t.Button,{type:"submit",disabled:d,children:d?"Kaydediliyor...":c?"Guncelle":"Kaydet"})]})]})]})})}function eg({open:e,onOpenChange:n,accounts:c,defaultType:d="deposit"}){var m;let[o,x]=(0,s.useState)(!1),[h,u]=(0,s.useState)({accountId:"",type:d,amount:0,description:"",reference:"",targetAccountId:"",date:new Date().toISOString().split("T")[0]});(0,s.useEffect)(()=>{e&&u({accountId:c[0]?.id||"",type:d,amount:0,description:"",reference:"",targetAccountId:"",date:new Date().toISOString().split("T")[0]})},[e,d,c]);let g=async e=>{if(e.preventDefault(),!h.accountId||!h.amount||h.amount<=0)return void R.toast.error("Lutfen hesap secin ve gecerli tutar girin");if(["transfer","eft","havale"].includes(h.type)&&!h.targetAccountId)return void R.toast.error("Transfer islemleri icin hedef hesap secin");x(!0);try{await (0,I.addFirestoreData)("transactions",{...h,accountType:"bank",createdAt:new Date().toISOString()});let e=c.find(e=>e.id===h.accountId);if(e){let a=e.balance||0,s="deposit"===h.type?a+h.amount:a-h.amount;await (0,I.updateFirestoreData)("bankAccounts",h.accountId,{balance:s})}if("transfer"===h.type&&h.targetAccountId){let e=c.find(e=>e.id===h.targetAccountId);if(e){let a=e.balance||0;await (0,I.updateFirestoreData)("bankAccounts",h.targetAccountId,{balance:a+h.amount})}}R.toast.success("Islem kaydedildi"),n(!1)}catch(e){R.toast.error("Islem basarisiz: "+e.message)}finally{x(!1)}},p=["transfer","eft","havale"].includes(h.type);return(0,a.jsx)(eo.Dialog,{open:e,onOpenChange:n,children:(0,a.jsxs)(eo.DialogContent,{className:"max-w-lg",children:[(0,a.jsx)(eo.DialogHeader,{children:(0,a.jsxs)(eo.DialogTitle,{className:"flex items-center gap-2",children:[(e=>{switch(e){case"deposit":return(0,a.jsx)(U,{className:"h-4 w-4 text-green-600"});case"withdrawal":return(0,a.jsx)(_,{className:"h-4 w-4 text-red-600"});default:return(0,a.jsx)(ex,{className:"h-4 w-4 text-amber-600"})}})(h.type),{deposit:"Para Yatirma",withdrawal:"Para Cekme",transfer:"Hesaplar Arasi Transfer",eft:"EFT Gonderimi",havale:"Havale Gonderimi"}[m=h.type]||m]})}),(0,a.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Islem Tipi"}),(0,a.jsxs)(r.Select,{value:h.type,onValueChange:e=>u({...h,type:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{})}),(0,a.jsxs)(r.SelectContent,{children:[(0,a.jsx)(r.SelectItem,{value:"deposit",children:"Para Yatirma"}),(0,a.jsx)(r.SelectItem,{value:"withdrawal",children:"Para Cekme"}),(0,a.jsx)(r.SelectItem,{value:"transfer",children:"Hesaplar Arasi Transfer"}),(0,a.jsx)(r.SelectItem,{value:"eft",children:"EFT Gonderimi"}),(0,a.jsx)(r.SelectItem,{value:"havale",children:"Havale Gonderimi"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:p?"Kaynak Hesap *":"Hesap *"}),(0,a.jsxs)(r.Select,{value:h.accountId,onValueChange:e=>u({...h,accountId:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{placeholder:"Hesap secin"})}),(0,a.jsx)(r.SelectContent,{children:c.filter(e=>e.id&&!1!==e.isActive).map(e=>(0,a.jsxs)(r.SelectItem,{value:e.id,children:[e.name," - ",e.bankName," (",e.currency," ",(e.balance||0).toLocaleString(),")"]},e.id))})]})]}),p&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Hedef Hesap / IBAN *"}),"transfer"===h.type?(0,a.jsxs)(r.Select,{value:h.targetAccountId,onValueChange:e=>u({...h,targetAccountId:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{placeholder:"Hedef hesap secin"})}),(0,a.jsx)(r.SelectContent,{children:c.filter(e=>e.id&&!1!==e.isActive&&e.id!==h.accountId).map(e=>(0,a.jsxs)(r.SelectItem,{value:e.id,children:[e.name," - ",e.bankName]},e.id))})]}):(0,a.jsx)(l.Input,{value:h.targetAccountId||"",onChange:e=>u({...h,targetAccountId:e.target.value.toUpperCase()}),placeholder:"Alici IBAN"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Tutar *"}),(0,a.jsx)(l.Input,{type:"number",step:"0.01",min:"0.01",value:h.amount||"",onChange:e=>u({...h,amount:parseFloat(e.target.value)||0}),placeholder:"0.00"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Tarih"}),(0,a.jsx)(l.Input,{type:"date",value:h.date,onChange:e=>u({...h,date:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Aciklama"}),(0,a.jsx)(l.Input,{value:h.description,onChange:e=>u({...h,description:e.target.value}),placeholder:"Islem aciklamasi"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Referans No"}),(0,a.jsx)(l.Input,{value:h.reference||"",onChange:e=>u({...h,reference:e.target.value}),placeholder:"Dekont/referans numarasi"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,a.jsx)(t.Button,{type:"button",variant:"outline",onClick:()=>n(!1),disabled:o,children:"Iptal"}),(0,a.jsx)(t.Button,{type:"submit",disabled:o,className:"deposit"===h.type?"bg-green-600 hover:bg-green-700":"withdrawal"===h.type?"bg-red-600 hover:bg-red-700":"bg-amber-600 hover:bg-amber-700",children:o?"Kaydediliyor...":"Islemi Kaydet"})]})]})]})})}function ep({open:e,onOpenChange:s,accounts:l,onEdit:i,onDelete:r}){return(0,a.jsx)(eo.Dialog,{open:e,onOpenChange:s,children:(0,a.jsxs)(eo.DialogContent,{className:"max-w-3xl max-h-[80vh] overflow-auto",children:[(0,a.jsx)(eo.DialogHeader,{children:(0,a.jsxs)(eo.DialogTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(O.Building2,{className:"h-5 w-5"}),"Banka Hesaplari"]})}),(0,a.jsx)("div",{className:"space-y-3",children:0===l.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Henuz banka hesabi eklenmemis"}):l.map(e=>(0,a.jsx)("div",{className:`p-4 border rounded-lg ${!1!==e.isActive?"bg-white":"bg-gray-50 opacity-60"}`,children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:e.name}),!1===e.isActive&&(0,a.jsx)("span",{className:"text-xs bg-gray-200 text-gray-600 px-2 py-0.5 rounded",children:"Pasif"})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[e.bankName," ",e.branch&&`- ${e.branch}`]}),(0,a.jsx)("p",{className:"text-xs text-gray-400 font-mono mt-1",children:e.iban})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-lg font-semibold",children:[e.currency," ",(e.balance||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsxs)(t.Button,{size:"sm",variant:"outline",onClick:()=>{i(e),s(!1)},children:[(0,a.jsx)(Y.Edit,{className:"h-3 w-3 mr-1"})," Duzenle"]}),(0,a.jsxs)(t.Button,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",onClick:()=>r(e),children:[(0,a.jsx)(W.Trash2,{className:"h-3 w-3 mr-1"})," Sil"]})]})]})]})},e.id))}),(0,a.jsx)("div",{className:"flex justify-end pt-4",children:(0,a.jsx)(t.Button,{variant:"outline",onClick:()=>s(!1),children:"Kapat"})})]})})}let ej=(0,P.default)("door-open",[["path",{d:"M11 20H2",key:"nlcfvz"}],["path",{d:"M11 4.562v16.157a1 1 0 0 0 1.242.97L19 20V5.562a2 2 0 0 0-1.515-1.94l-4-1A2 2 0 0 0 11 4.561z",key:"au4z13"}],["path",{d:"M11 4H8a2 2 0 0 0-2 2v14",key:"74r1mk"}],["path",{d:"M14 12h.01",key:"1jfl7z"}],["path",{d:"M22 20h-3",key:"vhrsz"}]]),eb=(0,P.default)("door-closed",[["path",{d:"M10 12h.01",key:"1kxr2c"}],["path",{d:"M18 20V6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14",key:"36qu9e"}],["path",{d:"M2 20h20",key:"owomy5"}]]),eN=[{value:500,label:"500 EUR"},{value:200,label:"200 EUR"},{value:100,label:"100 EUR"},{value:50,label:"50 EUR"},{value:20,label:"20 EUR"},{value:10,label:"10 EUR"},{value:5,label:"5 EUR"},{value:2,label:"2 EUR"},{value:1,label:"1 EUR"},{value:.5,label:"50 Cent"},{value:.2,label:"20 Cent"},{value:.1,label:"10 Cent"},{value:.05,label:"5 Cent"},{value:.02,label:"2 Cent"},{value:.01,label:"1 Cent"}];function ev({open:e,onOpenChange:r}){let[n,c]=(0,s.useState)(!1),[d,m]=(0,s.useState)({}),[o,x]=(0,s.useState)("");(0,s.useEffect)(()=>{e&&(m({}),x(""))},[e]);let h=Object.entries(d).reduce((e,[a,s])=>e+parseFloat(a)*(s||0),0),u=async e=>{e.preventDefault(),c(!0);try{await (0,I.addFirestoreData)("cashRegisters",{date:new Date().toISOString().split("T")[0],openingBalance:h,expectedBalance:h,status:"open",openedAt:new Date().toISOString(),openedBy:"user",notes:o}),R.toast.success("Kasa acildi"),r(!1)}catch(e){R.toast.error("Kasa acilamadi: "+e.message)}finally{c(!1)}};return(0,a.jsx)(eo.Dialog,{open:e,onOpenChange:r,children:(0,a.jsxs)(eo.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-auto",children:[(0,a.jsx)(eo.DialogHeader,{children:(0,a.jsxs)(eo.DialogTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(ej,{className:"h-5 w-5 text-green-600"}),"Kasa Acilisi"]})}),(0,a.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[(0,a.jsx)(X.Calculator,{className:"h-4 w-4"}),"Para Sayimi"]}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-3",children:eN.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm w-16",children:e.label}),(0,a.jsx)(l.Input,{type:"number",min:"0",className:"w-20 h-8 text-center",value:d[e.value]||"",onChange:a=>m({...d,[e.value]:parseInt(a.target.value)||0}),placeholder:"0"}),(0,a.jsxs)("span",{className:"text-xs text-gray-500 w-20",children:["= ",((d[e.value]||0)*e.value).toFixed(2)]})]},e.value))})]}),(0,a.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium",children:"Toplam Acilis Bakiyesi:"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-green-600",children:["EUR ",h.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Notlar"}),(0,a.jsx)(l.Input,{value:o,onChange:e=>x(e.target.value),placeholder:"Acilis notlari (opsiyonel)"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,a.jsx)(t.Button,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:n,children:"Iptal"}),(0,a.jsxs)(t.Button,{type:"submit",className:"bg-green-600 hover:bg-green-700",disabled:n,children:[(0,a.jsx)(ej,{className:"h-4 w-4 mr-2"}),n?"Aciliyor...":"Kasayi Ac"]})]})]})]})})}function ey({open:e,onOpenChange:r,currentRegister:n}){let[c,d]=(0,s.useState)(!1),[m,o]=(0,s.useState)({}),[x,h]=(0,s.useState)("");(0,s.useEffect)(()=>{e&&(o({}),h(""))},[e]);let u=Object.entries(m).reduce((e,[a,s])=>e+parseFloat(a)*(s||0),0),g=n?.expectedBalance||n?.openingBalance||0,p=u-g,j=async e=>{if(e.preventDefault(),!n?.id)return void R.toast.error("Acik kasa bulunamadi");if(0===p||confirm(`Kasa farki: ${p>0?"+":""}${p.toFixed(2)} EUR

Devam etmek istiyor musunuz?`)){d(!0);try{await (0,I.updateFirestoreData)("cashRegisters",n.id,{closingBalance:u,status:"closed",closedAt:new Date().toISOString(),closedBy:"user",notes:x||n.notes}),R.toast.success("Kasa kapatildi"),r(!1)}catch(e){R.toast.error("Kasa kapatilamadi: "+e.message)}finally{d(!1)}}};return(0,a.jsx)(eo.Dialog,{open:e,onOpenChange:r,children:(0,a.jsxs)(eo.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-auto",children:[(0,a.jsx)(eo.DialogHeader,{children:(0,a.jsxs)(eo.DialogTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(eb,{className:"h-5 w-5 text-red-600"}),"Kasa Kapanisi"]})}),(0,a.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[n&&(0,a.jsx)("div",{className:"bg-amber-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Acilis Bakiyesi:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:["EUR ",(n.openingBalance||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Beklenen Bakiye:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:["EUR ",g.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Acilis Zamani:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:n.openedAt?new Date(n.openedAt).toLocaleString("tr-TR"):"-"})]})]})}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[(0,a.jsx)(X.Calculator,{className:"h-4 w-4"}),"Para Sayimi"]}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-3",children:eN.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm w-16",children:e.label}),(0,a.jsx)(l.Input,{type:"number",min:"0",className:"w-20 h-8 text-center",value:m[e.value]||"",onChange:a=>o({...m,[e.value]:parseInt(a.target.value)||0}),placeholder:"0"}),(0,a.jsxs)("span",{className:"text-xs text-gray-500 w-20",children:["= ",((m[e.value]||0)*e.value).toFixed(2)]})]},e.value))})]}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{children:"Sayilan Tutar:"}),(0,a.jsxs)("span",{className:"text-xl font-bold",children:["EUR ",u.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Fark:"}),(0,a.jsxs)("span",{className:`text-xl font-bold ${0===p?"text-green-600":p>0?"text-amber-600":"text-red-600"}`,children:[p>0?"+":"",p.toLocaleString("tr-TR",{minimumFractionDigits:2})," EUR",0===p&&" âœ“"]})]})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Notlar"}),(0,a.jsx)(l.Input,{value:x,onChange:e=>h(e.target.value),placeholder:"Kapanis notlari (opsiyonel)"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,a.jsx)(t.Button,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:c,children:"Iptal"}),(0,a.jsxs)(t.Button,{type:"submit",className:"bg-red-600 hover:bg-red-700",disabled:c,children:[(0,a.jsx)(eb,{className:"h-4 w-4 mr-2"}),c?"Kapatiliyor...":"Kasayi Kapat"]})]})]})]})})}function ef({open:e,onOpenChange:n,type:c}){let[d,m]=(0,s.useState)(!1),[o,x]=(0,s.useState)({type:c,amount:0,description:"",category:"",paymentMethod:"cash",reference:"",customerName:"",date:new Date().toISOString().split("T")[0]});(0,s.useEffect)(()=>{e&&x({type:c,amount:0,description:"",category:"",paymentMethod:"cash",reference:"",customerName:"",date:new Date().toISOString().split("T")[0]})},[e,c]);let h=async e=>{if(e.preventDefault(),!o.amount||o.amount<=0)return void R.toast.error("Gecerli tutar girin");m(!0);try{await (0,I.addFirestoreData)("transactions",{...o,accountType:"cash",createdAt:new Date().toISOString()}),R.toast.success("Islem kaydedildi"),n(!1)}catch(e){R.toast.error("Islem kaydedilemedi: "+e.message)}finally{m(!1)}},u="income"===o.type?[{value:"sales",label:"Satis"},{value:"service",label:"Hizmet"},{value:"collection",label:"Tahsilat"},{value:"refund_received",label:"Iade Alindi"},{value:"other_income",label:"Diger Giris"}]:[{value:"purchase",label:"Alis"},{value:"payment",label:"Odeme"},{value:"refund_given",label:"Iade Verildi"},{value:"salary",label:"Maas"},{value:"rent",label:"Kira"},{value:"utilities",label:"Faturalar"},{value:"supplies",label:"Malzeme"},{value:"transport",label:"Ulasim"},{value:"other_expense",label:"Diger Cikis"}];return(0,a.jsx)(eo.Dialog,{open:e,onOpenChange:n,children:(0,a.jsxs)(eo.DialogContent,{className:"max-w-lg",children:[(0,a.jsx)(eo.DialogHeader,{children:(0,a.jsxs)(eo.DialogTitle,{className:"flex items-center gap-2",children:["income"===o.type?(0,a.jsx)(U,{className:"h-5 w-5 text-green-600"}):(0,a.jsx)(_,{className:"h-5 w-5 text-red-600"}),"income"===o.type?"Kasaya Giris":"Kasadan Cikis"]})}),(0,a.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Islem Tipi"}),(0,a.jsxs)(r.Select,{value:o.type,onValueChange:e=>x({...o,type:e,category:""}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{})}),(0,a.jsxs)(r.SelectContent,{children:[(0,a.jsx)(r.SelectItem,{value:"income",children:"Giris"}),(0,a.jsx)(r.SelectItem,{value:"expense",children:"Cikis"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Tutar *"}),(0,a.jsx)(l.Input,{type:"number",step:"0.01",min:"0.01",value:o.amount||"",onChange:e=>x({...o,amount:parseFloat(e.target.value)||0}),placeholder:"0.00"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Kategori"}),(0,a.jsxs)(r.Select,{value:o.category,onValueChange:e=>x({...o,category:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{placeholder:"Kategori secin"})}),(0,a.jsx)(r.SelectContent,{children:u.map(e=>(0,a.jsx)(r.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Odeme Yontemi"}),(0,a.jsxs)(r.Select,{value:o.paymentMethod,onValueChange:e=>x({...o,paymentMethod:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{})}),(0,a.jsxs)(r.SelectContent,{children:[(0,a.jsx)(r.SelectItem,{value:"cash",children:"Nakit"}),(0,a.jsx)(r.SelectItem,{value:"card",children:"Kart"}),(0,a.jsx)(r.SelectItem,{value:"check",children:"Cek"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Tarih"}),(0,a.jsx)(l.Input,{type:"date",value:o.date,onChange:e=>x({...o,date:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Musteri/Tedarikci"}),(0,a.jsx)(l.Input,{value:o.customerName,onChange:e=>x({...o,customerName:e.target.value}),placeholder:"Isim (opsiyonel)"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Aciklama"}),(0,a.jsx)(l.Input,{value:o.description,onChange:e=>x({...o,description:e.target.value}),placeholder:"Islem aciklamasi"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Fis/Referans No"}),(0,a.jsx)(l.Input,{value:o.reference,onChange:e=>x({...o,reference:e.target.value}),placeholder:"Fis numarasi (opsiyonel)"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,a.jsx)(t.Button,{type:"button",variant:"outline",onClick:()=>n(!1),disabled:d,children:"Iptal"}),(0,a.jsx)(t.Button,{type:"submit",disabled:d,className:"income"===o.type?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",children:"income"===o.type?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(U,{className:"h-4 w-4 mr-2"})," ",d?"Kaydediliyor...":"Girisi Kaydet"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_,{className:"h-4 w-4 mr-2"})," ",d?"Kaydediliyor...":"Cikisi Kaydet"]})})]})]})]})})}var eT=e.i(95468),ek=e.i(63209);let eS=[{value:"business",label:"Ticari Kredi"},{value:"personal",label:"Ihtiyac Kredisi"},{value:"mortgage",label:"Konut Kredisi"},{value:"vehicle",label:"Tasit Kredisi"},{value:"other",label:"Diger"}],ew=["NLB d.d.","Nova KBM","SKB Banka","Addiko Bank","Unicredit Banka","Sparkasse","Ziraat Bankasi","Is Bankasi","Garanti BBVA","Yapi Kredi","Akbank","Diger"];function eD({open:e,onOpenChange:n,credit:c,bankAccounts:d}){let[m,o]=(0,s.useState)(!1),[x,h]=(0,s.useState)({bankName:"",creditType:"business",amount:0,interestRate:0,term:12,monthlyPayment:0,startDate:new Date().toISOString().split("T")[0],endDate:"",paidAmount:0,remainingAmount:0,accountNumber:"",currency:"EUR",status:"active",notes:""});(0,s.useEffect)(()=>{if(c)h({bankName:c.bankName||"",creditType:c.creditType||"business",amount:c.amount||0,interestRate:c.interestRate||0,term:c.term||12,monthlyPayment:c.monthlyPayment||0,startDate:c.startDate||new Date().toISOString().split("T")[0],endDate:c.endDate||"",paidAmount:c.paidAmount||0,remainingAmount:c.remainingAmount||0,accountNumber:c.accountNumber||"",currency:c.currency||"EUR",status:c.status||"active",notes:c.notes||""});else{let e=new Date,a=new Date(e);a.setMonth(a.getMonth()+12),h({bankName:"",creditType:"business",amount:0,interestRate:0,term:12,monthlyPayment:0,startDate:e.toISOString().split("T")[0],endDate:a.toISOString().split("T")[0],paidAmount:0,remainingAmount:0,accountNumber:"",currency:"EUR",status:"active",notes:""})}},[c,e]),(0,s.useEffect)(()=>{if(x.amount&&x.term&&x.interestRate){let e=x.interestRate/100/12,a=x.term,s=x.amount,t=e>0?e*Math.pow(1+e,a)*s/(Math.pow(1+e,a)-1):s/a;h(e=>({...e,monthlyPayment:Math.round(100*t)/100,remainingAmount:c?e.remainingAmount:s}))}},[x.amount,x.term,x.interestRate,c]),(0,s.useEffect)(()=>{if(x.startDate&&x.term){let e=new Date(x.startDate);e.setMonth(e.getMonth()+x.term),h(a=>({...a,endDate:e.toISOString().split("T")[0]}))}},[x.startDate,x.term]);let u=async e=>{if(e.preventDefault(),!x.bankName||!x.amount)return void R.toast.error("Lutfen zorunlu alanlari doldurun");o(!0);try{c?.id?(await (0,I.updateFirestoreData)("credits",c.id,x),R.toast.success("Kredi guncellendi")):(await (0,I.addFirestoreData)("credits",{...x,createdAt:new Date().toISOString()}),R.toast.success("Kredi eklendi")),n(!1)}catch(e){R.toast.error("Islem basarisiz: "+e.message)}finally{o(!1)}};return(0,a.jsx)(eo.Dialog,{open:e,onOpenChange:n,children:(0,a.jsxs)(eo.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-auto",children:[(0,a.jsx)(eo.DialogHeader,{children:(0,a.jsxs)(eo.DialogTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(E.CreditCard,{className:"h-5 w-5"}),c?"Kredi Duzenle":"Yeni Kredi Ekle"]})}),(0,a.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Banka *"}),(0,a.jsxs)(r.Select,{value:x.bankName,onValueChange:e=>h({...x,bankName:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{placeholder:"Banka secin"})}),(0,a.jsx)(r.SelectContent,{children:ew.map(e=>(0,a.jsx)(r.SelectItem,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Kredi Turu *"}),(0,a.jsxs)(r.Select,{value:x.creditType,onValueChange:e=>h({...x,creditType:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{})}),(0,a.jsx)(r.SelectContent,{children:eS.map(e=>(0,a.jsx)(r.SelectItem,{value:e.value,children:e.label},e.value))})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Kredi Tutari *"}),(0,a.jsx)(l.Input,{type:"number",step:"0.01",value:x.amount||"",onChange:e=>h({...x,amount:parseFloat(e.target.value)||0}),placeholder:"0.00"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Faiz Orani (%)"}),(0,a.jsx)(l.Input,{type:"number",step:"0.01",value:x.interestRate||"",onChange:e=>h({...x,interestRate:parseFloat(e.target.value)||0}),placeholder:"0.00"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Para Birimi"}),(0,a.jsxs)(r.Select,{value:x.currency,onValueChange:e=>h({...x,currency:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{})}),(0,a.jsxs)(r.SelectContent,{children:[(0,a.jsx)(r.SelectItem,{value:"EUR",children:"EUR"}),(0,a.jsx)(r.SelectItem,{value:"USD",children:"USD"}),(0,a.jsx)(r.SelectItem,{value:"TRY",children:"TRY"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Vade (Ay)"}),(0,a.jsx)(l.Input,{type:"number",min:"1",value:x.term||"",onChange:e=>h({...x,term:parseInt(e.target.value)||12})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Aylik Taksit (Hesaplanan)"}),(0,a.jsx)(l.Input,{type:"number",value:x.monthlyPayment||"",onChange:e=>h({...x,monthlyPayment:parseFloat(e.target.value)||0}),className:"bg-gray-50"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Hesap No"}),(0,a.jsx)(l.Input,{value:x.accountNumber,onChange:e=>h({...x,accountNumber:e.target.value}),placeholder:"Kredi hesap no"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Baslangic Tarihi"}),(0,a.jsx)(l.Input,{type:"date",value:x.startDate,onChange:e=>h({...x,startDate:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Bitis Tarihi"}),(0,a.jsx)(l.Input,{type:"date",value:x.endDate,readOnly:!0,className:"bg-gray-50"})]})]}),c&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Odenen Tutar"}),(0,a.jsx)(l.Input,{type:"number",step:"0.01",value:x.paidAmount||"",onChange:e=>h({...x,paidAmount:parseFloat(e.target.value)||0})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Kalan Borc"}),(0,a.jsx)(l.Input,{type:"number",step:"0.01",value:x.remainingAmount||"",onChange:e=>h({...x,remainingAmount:parseFloat(e.target.value)||0})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Durum"}),(0,a.jsxs)(r.Select,{value:x.status,onValueChange:e=>h({...x,status:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{})}),(0,a.jsxs)(r.SelectContent,{children:[(0,a.jsx)(r.SelectItem,{value:"active",children:"Aktif"}),(0,a.jsx)(r.SelectItem,{value:"completed",children:"Tamamlandi"}),(0,a.jsx)(r.SelectItem,{value:"defaulted",children:"Temerrut"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Notlar"}),(0,a.jsx)(l.Input,{value:x.notes,onChange:e=>h({...x,notes:e.target.value}),placeholder:"Ek notlar (opsiyonel)"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,a.jsx)(t.Button,{type:"button",variant:"outline",onClick:()=>n(!1),disabled:m,children:"Iptal"}),(0,a.jsx)(t.Button,{type:"submit",disabled:m,children:m?"Kaydediliyor...":c?"Guncelle":"Kaydet"})]})]})]})})}function eC({open:e,onOpenChange:s,credit:l,payments:i}){var r;let n;if(!l)return null;let c=(l.paidAmount||0)/(l.amount||1)*100;return(0,a.jsx)(eo.Dialog,{open:e,onOpenChange:s,children:(0,a.jsxs)(eo.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-auto",children:[(0,a.jsx)(eo.DialogHeader,{children:(0,a.jsxs)(eo.DialogTitle,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(E.CreditCard,{className:"h-5 w-5"}),l.bankName," - ",eS.find(e=>e.value===l.creditType)?.label]}),(r=l.status||"active",n={active:(0,a.jsx)(ee.Clock,{className:"h-3 w-3"}),completed:(0,a.jsx)(eT.CheckCircle2,{className:"h-3 w-3"}),defaulted:(0,a.jsx)(ek.AlertCircle,{className:"h-3 w-3"})},(0,a.jsxs)("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${{active:"bg-green-100 text-green-800",completed:"bg-amber-100 text-amber-800",defaulted:"bg-red-100 text-red-800"}[r]||"bg-gray-100"}`,children:[n[r],{active:"Aktif",completed:"Tamamlandi",defaulted:"Temerrut"}[r]||r]}))]})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Toplam Kredi"}),(0,a.jsxs)("p",{className:"text-xl font-semibold",children:[l.currency," ",(l.amount||0).toLocaleString("tr-TR")]})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Odenen"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-green-600",children:[l.currency," ",(l.paidAmount||0).toLocaleString("tr-TR")]})]}),(0,a.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Kalan Borc"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-red-600",children:[l.currency," ",(l.remainingAmount||0).toLocaleString("tr-TR")]})]}),(0,a.jsxs)("div",{className:"bg-amber-50 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Aylik Taksit"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-amber-600",children:[l.currency," ",(l.monthlyPayment||0).toLocaleString("tr-TR")]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Odeme Ilerlemesi"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[c.toFixed(0),"% tamamlandi"]})]}),(0,a.jsx)(A.Progress,{value:c,className:"h-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Kredi Bilgileri"}),(0,a.jsxs)("div",{className:"text-sm space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Banka:"}),(0,a.jsx)("span",{children:l.bankName})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Kredi Turu:"}),(0,a.jsx)("span",{children:eS.find(e=>e.value===l.creditType)?.label})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Faiz Orani:"}),(0,a.jsxs)("span",{children:["%",l.interestRate]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Vade:"}),(0,a.jsxs)("span",{children:[l.term," ay"]})]}),l.accountNumber&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Hesap No:"}),(0,a.jsx)("span",{className:"font-mono",children:l.accountNumber})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Tarihler"}),(0,a.jsxs)("div",{className:"text-sm space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Baslangic:"}),(0,a.jsx)("span",{children:l.startDate})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Bitis:"}),(0,a.jsx)("span",{children:l.endDate})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-3",children:"Son Odemeler"}),0===i.length?(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"Henuz odeme yapilmamis"}):(0,a.jsx)("div",{className:"border rounded-lg divide-y max-h-48 overflow-auto",children:i.slice(0,10).map(e=>(0,a.jsxs)("div",{className:"p-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:["Taksit #",e.paymentNumber]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.paidDate||e.dueDate})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-medium",children:[l.currency," ",(e.amount||0).toLocaleString("tr-TR")]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Ana para: ",(e.principal||0).toLocaleString("tr-TR")," | Faiz: ",(e.interest||0).toLocaleString("tr-TR")]})]})]},e.id))})]})]}),(0,a.jsx)("div",{className:"flex justify-end gap-3 pt-4",children:(0,a.jsx)(t.Button,{variant:"outline",onClick:()=>s(!1),children:"Kapat"})})]})})}function eA({open:e,onOpenChange:n,credit:c,bankAccounts:d}){let[m,o]=(0,s.useState)(!1),[x,h]=(0,s.useState)({amount:0,paidDate:new Date().toISOString().split("T")[0],paymentNumber:1,principal:0,interest:0,lateFee:0,reference:"",notes:"",fromAccountId:""});(0,s.useEffect)(()=>{c&&e&&h({amount:c.monthlyPayment||0,paidDate:new Date().toISOString().split("T")[0],paymentNumber:1,principal:0,interest:0,lateFee:0,reference:"",notes:"",fromAccountId:d[0]?.id||""})},[c,e,d]),(0,s.useEffect)(()=>{if(c&&x.amount){let e=(c.interestRate||0)/100/12,a=(c.remainingAmount||0)*e,s=x.amount-a-x.lateFee;h(e=>({...e,interest:Math.round(100*a)/100,principal:Math.round(100*Math.max(0,s))/100}))}},[c,x.amount,x.lateFee]);let u=async e=>{if(e.preventDefault(),!c?.id||!x.amount||x.amount<=0)return void R.toast.error("Gecerli tutar girin");o(!0);try{await (0,I.addFirestoreData)("creditPayments",{creditId:c.id,amount:x.amount,paidDate:x.paidDate,paymentNumber:x.paymentNumber,principal:x.principal,interest:x.interest,status:"paid",reference:x.reference,notes:x.notes,createdAt:new Date().toISOString()});let e=(c.paidAmount||0)+x.amount,a=Math.max(0,(c.remainingAmount||c.amount||0)-x.principal);if(await (0,I.updateFirestoreData)("credits",c.id,{paidAmount:e,remainingAmount:a,status:a<=0?"completed":"active"}),x.fromAccountId){let e=d.find(e=>e.id===x.fromAccountId);e&&(await (0,I.updateFirestoreData)("bankAccounts",x.fromAccountId,{balance:(e.balance||0)-x.amount}),await (0,I.addFirestoreData)("transactions",{accountId:x.fromAccountId,accountType:"bank",type:"withdrawal",amount:x.amount,description:`Kredi taksit odemesi - ${c.bankName}`,date:x.paidDate,reference:x.reference,createdAt:new Date().toISOString()}))}R.toast.success("Odeme kaydedildi"),n(!1)}catch(e){R.toast.error("Odeme kaydedilemedi: "+e.message)}finally{o(!1)}};return c?(0,a.jsx)(eo.Dialog,{open:e,onOpenChange:n,children:(0,a.jsxs)(eo.DialogContent,{className:"max-w-lg",children:[(0,a.jsx)(eo.DialogHeader,{children:(0,a.jsxs)(eo.DialogTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)($.DollarSign,{className:"h-5 w-5 text-green-600"}),"Taksit Odemesi - ",c.bankName]})}),(0,a.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,a.jsx)("div",{className:"bg-amber-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Kalan Borc:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[c.currency," ",(c.remainingAmount||0).toLocaleString("tr-TR")]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Aylik Taksit:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[c.currency," ",(c.monthlyPayment||0).toLocaleString("tr-TR")]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Taksit No"}),(0,a.jsx)(l.Input,{type:"number",value:x.paymentNumber,onChange:e=>h({...x,paymentNumber:parseInt(e.target.value)||1})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Odeme Tarihi"}),(0,a.jsx)(l.Input,{type:"date",value:x.paidDate,onChange:e=>h({...x,paidDate:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Odeme Tutari *"}),(0,a.jsx)(l.Input,{type:"number",step:"0.01",value:x.amount||"",onChange:e=>h({...x,amount:parseFloat(e.target.value)||0}),placeholder:"0.00"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Gecikme Bedeli"}),(0,a.jsx)(l.Input,{type:"number",step:"0.01",value:x.lateFee||"",onChange:e=>h({...x,lateFee:parseFloat(e.target.value)||0}),placeholder:"0.00"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Odeme Yapilacak Hesap"}),(0,a.jsxs)(r.Select,{value:x.fromAccountId,onValueChange:e=>h({...x,fromAccountId:e}),children:[(0,a.jsx)(r.SelectTrigger,{children:(0,a.jsx)(r.SelectValue,{placeholder:"Hesap secin"})}),(0,a.jsxs)(r.SelectContent,{children:[(0,a.jsx)(r.SelectItem,{value:"manual",children:"Manuel odeme"}),d.filter(e=>e.id&&!1!==e.isActive).map(e=>(0,a.jsxs)(r.SelectItem,{value:e.id,children:[e.name," - ",e.bankName," (",e.currency," ",(e.balance||0).toLocaleString(),")"]},e.id))]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Odeme Dagilimi (Hesaplanan)"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Ana Para:"}),(0,a.jsxs)("span",{children:[c.currency," ",x.principal.toLocaleString("tr-TR")]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Faiz:"}),(0,a.jsxs)("span",{children:[c.currency," ",x.interest.toLocaleString("tr-TR")]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Referans/Dekont No"}),(0,a.jsx)(l.Input,{value:x.reference,onChange:e=>h({...x,reference:e.target.value}),placeholder:"Odeme referansi"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Notlar"}),(0,a.jsx)(l.Input,{value:x.notes,onChange:e=>h({...x,notes:e.target.value}),placeholder:"Ek notlar (opsiyonel)"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,a.jsx)(t.Button,{type:"button",variant:"outline",onClick:()=>n(!1),disabled:m,children:"Iptal"}),(0,a.jsxs)(t.Button,{type:"submit",className:"bg-green-600 hover:bg-green-700",disabled:m,children:[(0,a.jsx)(eT.CheckCircle2,{className:"h-4 w-4 mr-2"}),m?"Kaydediliyor...":"Odemeyi Kaydet"]})]})]})]})}):null}let eI={genel:{name:"Genel Giderler",icon:"ðŸ¢",color:"bg-gray-100 text-gray-700"},merkez:{name:"Merkez Depo",icon:"ðŸ­",color:"bg-blue-100 text-blue-700"},balkan:{name:"Balkan Market",icon:"ðŸ›’",color:"bg-green-100 text-green-700"},desetka:{name:"Desetka Market",icon:"ðŸ›’",color:"bg-purple-100 text-purple-700"},mesnica:{name:"Mesnica Kasap",icon:"ðŸ¥©",color:"bg-red-100 text-red-700"}};function eR({type:e}){return(0,a.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${{income:"bg-green-100 text-green-800",expense:"bg-red-100 text-red-800",transfer:"bg-amber-100 text-amber-800",deposit:"bg-green-100 text-green-800",withdrawal:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-600"}`,children:{income:"Giris",expense:"Cikis",transfer:"Transfer",deposit:"Yatirma",withdrawal:"Cekme"}[e]||e})}function eB({status:e}){return(0,a.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${{active:"bg-green-100 text-green-800",completed:"bg-amber-100 text-amber-800",defaulted:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800",paid:"bg-green-100 text-green-800",late:"bg-red-100 text-red-800",open:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800"}[e]||"bg-gray-100 text-gray-600"}`,children:{active:"Aktif",completed:"Tamamlandi",defaulted:"Temerrut",pending:"Bekliyor",paid:"Odendi",late:"Gecikti",open:"Acik",closed:"Kapali"}[e]||e})}function eL(){let[e,n]=(0,s.useState)([]),[c,d]=(0,s.useState)([]),[m,o]=(0,s.useState)([]),[x,h]=(0,s.useState)([]),[u,g]=(0,s.useState)([]),[p,j]=(0,s.useState)([]),[b,N]=(0,s.useState)(!0),[v,y]=(0,s.useState)(!0),[f,T]=(0,s.useState)([]),[k,P]=(0,s.useState)([]),[eo,ex]=(0,s.useState)([]),[eh,ej]=(0,s.useState)(new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0]),[eb,eN]=(0,s.useState)(new Date().toISOString().split("T")[0]),[eT,ek]=(0,s.useState)(!1),[eS,ew]=(0,s.useState)(""),[eL,eF]=(0,s.useState)(""),[eK,eV]=(0,s.useState)(""),[eH,eM]=(0,s.useState)("all"),[eO,eE]=(0,s.useState)("all"),[ez,e$]=(0,s.useState)(""),[eP,eU]=(0,s.useState)("all"),[e_,eG]=(0,s.useState)(new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0]),[eY,eW]=(0,s.useState)(new Date().toISOString().split("T")[0]),[eX,eZ]=(0,s.useState)(!1),[eq,eJ]=(0,s.useState)(!1),[eQ,e0]=(0,s.useState)(!1),[e2,e1]=(0,s.useState)(null),[e4,e6]=(0,s.useState)(!1),[e5,e3]=(0,s.useState)(!1),[e8,e7]=(0,s.useState)(!1),[e9,ae]=(0,s.useState)("income"),[aa,as]=(0,s.useState)(!1),[at,al]=(0,s.useState)(!1),[ai,ar]=(0,s.useState)(!1),[an,ac]=(0,s.useState)(null);(0,s.useEffect)(()=>{N(!0);let e=(0,I.subscribeToFirestore)("transactions",e=>{n(e||[]),N(!1)}),a=(0,I.subscribeToFirestore)("bankAccounts",e=>{d(e||[])}),s=(0,I.subscribeToFirestore)("cashRegisters",e=>{o(e||[])}),t=[],l=[],i=[],r=e=>({...e,id:e.id||e._id,bankName:e.bankName||e.bankaAdi||e.banka||"",creditType:e.creditType||e.krediTuru||e.tur||"",amount:Number(e.amount||e.tutar||e.miktar||0),interestRate:Number(e.interestRate||e.faizOrani||e.faiz||0),term:Number(e.term||e.vade||e.sure||0),monthlyPayment:Number(e.monthlyPayment||e.aylikTaksit||e.taksit||0),startDate:e.startDate||e.baslangicTarihi||e.baslangic||"",endDate:e.endDate||e.bitisTarihi||e.bitis||"",paidAmount:Number(e.paidAmount||e.odenenTutar||e.odenen||0),remainingAmount:Number(e.remainingAmount||e.kalanTutar||e.kalan||e.amount||e.tutar||0),status:e.status||e.durum||"active"}),c=()=>{h([...t,...l,...i].reduce((e,a)=>(e.find(e=>e.id===a.id)||e.push(a),e),[]))},m=(0,I.subscribeToFirestore)("credits",e=>{t=(e||[]).map(r),c()}),x=(0,I.subscribeToFirestore)("krediler",e=>{l=(e||[]).map(r),c()}),u=(0,I.subscribeToRTDB)("krediler",e=>{i=(e||[]).map(r),c()}),p=(0,I.subscribeToFirestore)("creditPayments",e=>{g(e||[])});y(!0);let b=(0,I.subscribeToBranches)(e=>{j(e||[]),y(!1)}),v=(0,I.subscribeToFirestore)("saleInvoices",e=>{T(e||[])}),f=(0,I.subscribeToFirestore)("purchaseInvoices",e=>{P(e||[])}),k=(0,I.subscribeToFirestore)("expenses",e=>{ex(e||[])});return()=>{e(),a(),s(),m(),x(),u(),p(),b(),v(),f(),k()}},[]);let ad=(0,s.useMemo)(()=>e.filter(e=>{let a=e.description||"",s=e.reference||"",t=eK.toLowerCase(),l=!eK||a.toLowerCase().includes(t)||s.toLowerCase().includes(t),i="all"===eH||e.type===eH,r="all"===eO||e.accountId===eO||e.accountType===eO,n=!ez||e.date&&e.date.startsWith(ez);return l&&i&&r&&n}).sort((e,a)=>{let s=new Date(e.date||e.createdAt||"");return new Date(a.date||a.createdAt||"").getTime()-s.getTime()}),[e,eK,eH,eO,ez]),am=(0,s.useMemo)(()=>x.filter(e=>"all"===eP||e.status===eP),[x,eP]),ao=(0,s.useMemo)(()=>{let a=m.filter(e=>"open"===e.status).sort((e,a)=>new Date(a.openedAt||"").getTime()-new Date(e.openedAt||"").getTime())[0],s=a?.openingBalance||0,t=c.filter(e=>!1!==e.isActive).reduce((e,a)=>e+(a.balance||0),0),l=x.filter(e=>"active"===e.status).reduce((e,a)=>e+(a.remainingAmount||0),0),i=s+t,r=new Date().toISOString().split("T")[0],n=e.filter(e=>e.date?.startsWith(r)||e.createdAt?.startsWith(r)),d=n.filter(e=>"income"===e.type||"deposit"===e.type).reduce((e,a)=>e+(a.amount||0),0);return{cashBalance:s,bankBalance:t,totalAssets:i,totalCreditDebt:l,netWorth:i-l,todayIncome:d,todayExpense:n.filter(e=>"expense"===e.type||"withdrawal"===e.type).reduce((e,a)=>e+(a.amount||0),0),upcomingPayments:u.filter(e=>"pending"===e.status).sort((e,a)=>new Date(e.dueDate||"").getTime()-new Date(a.dueDate||"").getTime()).slice(0,5),activeCredits:x.filter(e=>"active"===e.status).length}},[e,c,m,x,u]),ax=(0,s.useMemo)(()=>m.filter(e=>"open"===e.status).sort((e,a)=>new Date(a.openedAt||"").getTime()-new Date(e.openedAt||"").getTime())[0],[m]),ah=(0,s.useMemo)(()=>{let e=p.filter(e=>!1!==e.isActive),a=p.filter(e=>e.treasury?.cashRegister?.audit?.status==="open").length,s=p.reduce((e,a)=>e+(a.treasury?.cashRegister?.balance?.currentBalance||0),0),t=p.reduce((e,a)=>a.treasury?.bankAccounts?e+Object.values(a.treasury.bankAccounts).reduce((e,a)=>e+(a.balance?.currentBalance||0),0):e,0);return{totalBranches:p.length,activeBranches:e.length,openCashRegisters:a,closedCashRegisters:e.length-a,totalBranchCash:s,totalBranchBankBalance:t}},[p]),au=(0,s.useMemo)(()=>{let e=e=>{if(!e)return!1;let a=e.split("T")[0];return a>=eh&&a<=eb},a={};f.filter(a=>e(a.invoiceDate)&&"cancelled"!==a.status).forEach(e=>{let s=e.branchId||"merkez";a[s]||(a[s]={sales:0,vat:0,count:0}),a[s].sales+=e.subtotal||e.total||0,a[s].vat+=e.vatAmount||0,a[s].count++});let s={purchases:0,vat:0,count:0};k.filter(a=>e(a.invoiceDate)&&"cancelled"!==a.status).forEach(e=>{s.purchases+=e.subtotal||e.total||0,s.vat+=e.vatAmount||0,s.count++});let t={};eo.filter(a=>e(a.date)).forEach(e=>{let a=e.branchId||"genel";t[a]||(t[a]={expenses:0,vat:0,count:0}),t[a].expenses+=e.netAmount||e.grossAmount||e.totalAmount||0,t[a].vat+=e.ddvAmount||e.vatAmount||0,t[a].count++});let l=["merkez","balkan","desetka","mesnica"],i=l.reduce((e,s)=>e+(a[s]?.sales||0),0),r={};l.forEach(e=>{let s=a[e]?.sales||0;r[e]=i>0?s/i:.25});let n=t.genel||{expenses:0,vat:0,count:0},c=Object.keys(eI).map(e=>{let i=eI[e],c=a[e]||{sales:0,vat:0,count:0},d=t[e]||{expenses:0,vat:0,count:0},m=0,o=0,x=0,h=0;if(eT&&l.includes(e)){let a=r[e]||0;m=n.expenses*a,o=n.vat*a,x=s.purchases*a,h=s.vat*a}let u=eT?h:"merkez"===e?s.vat:0,g=eT?x:"merkez"===e?s.purchases:0,p="merkez"===e?s.count:0,j="genel"===e?eT?0:d.expenses:d.expenses+(eT?m:0),b="genel"===e?eT?0:d.vat:d.vat+(eT?o:0),N=c.vat-u-b;return{branchId:e,branchName:i.name,icon:i.icon,color:i.color,salesAmount:c.sales,salesVat:c.vat,salesCount:c.count,salesRatio:r[e]||0,purchaseAmount:g,purchaseVat:u,purchaseCount:p,expenseAmount:j,expenseVat:b,expenseCount:d.count,distributedExpense:eT?m:0,distributedExpenseVat:eT?o:0,distributedPurchaseVat:eT?h:0,netVat:N}}),d=c.reduce((e,a)=>e+a.salesVat,0),m=s.vat,o=eT?c.filter(e=>"genel"!==e.branchId).reduce((e,a)=>e+a.expenseVat,0):c.reduce((e,a)=>e+a.expenseVat,0);return{branchSummary:eT?c.filter(e=>"genel"!==e.branchId):c,totals:{salesVat:d,purchaseVat:m,expenseVat:o,netVat:d-m-o,salesAmount:c.reduce((e,a)=>e+a.salesAmount,0),purchaseAmount:s.purchases,expenseAmount:c.reduce((e,a)=>e+a.expenseAmount,0)},distribution:{enabled:eT,genelExpenses:n.expenses,genelExpenseVat:n.vat,salesRatios:r}}},[f,k,eo,eh,eb,eT]),ag=async e=>{if(confirm(`"${e.name}" hesabini silmek istediginize emin misiniz?`))try{await (0,I.deleteFirestoreData)("bankAccounts",e.id),R.toast.success("Banka hesabi silindi")}catch(e){R.toast.error("Hesap silinemedi: "+e.message)}},ap=async e=>{if(confirm(`"${e.bankName}" kredisini silmek istediginize emin misiniz?`))try{await (0,I.deleteFirestoreData)("credits",e.id),R.toast.success("Kredi silindi")}catch(e){R.toast.error("Kredi silinemedi: "+e.message)}},aj=async e=>{if(confirm("Bu islemi silmek istediginize emin misiniz?"))try{await (0,I.deleteFirestoreData)("transactions",e.id),R.toast.success("Islem silindi")}catch(e){R.toast.error("Islem silinemedi: "+e.message)}},ab=()=>{try{let a=ed.utils.book_new(),s=e.filter(e=>{let a=e.date||e.createdAt?.split("T")[0]||"";return a>=e_&&a<=eY}),t=[["MALI MUSAVIR RAPORU"],["Rapor Tarihi:",new Date().toLocaleDateString("tr-TR")],["Donem:",`${e_} - ${eY}`],[""],["HAZINE OZETI"],["Kasa Bakiyesi:",`â‚¬${ao.cashBalance.toLocaleString("tr-TR",{minimumFractionDigits:2})}`],["Banka Bakiyesi:",`â‚¬${ao.bankBalance.toLocaleString("tr-TR",{minimumFractionDigits:2})}`],["Toplam Varlik:",`â‚¬${ao.totalAssets.toLocaleString("tr-TR",{minimumFractionDigits:2})}`],["Kredi Borcu:",`â‚¬${ao.totalCreditDebt.toLocaleString("tr-TR",{minimumFractionDigits:2})}`],["Net Deger:",`â‚¬${ao.netWorth.toLocaleString("tr-TR",{minimumFractionDigits:2})}`],[""],["DONEM OZETI"],["Toplam Giris:",`â‚¬${s.filter(e=>["income","deposit"].includes(e.type||"")).reduce((e,a)=>e+(a.amount||0),0).toLocaleString("tr-TR",{minimumFractionDigits:2})}`],["Toplam Cikis:",`â‚¬${s.filter(e=>["expense","withdrawal"].includes(e.type||"")).reduce((e,a)=>e+(a.amount||0),0).toLocaleString("tr-TR",{minimumFractionDigits:2})}`],["Islem Sayisi:",s.length]],l=ed.utils.aoa_to_sheet(t);ed.utils.book_append_sheet(a,l,"Ozet");let i=s.map(e=>[e.date||e.createdAt?.split("T")[0]||"","income"===e.type?"Giris":"expense"===e.type?"Cikis":"deposit"===e.type?"Yatirma":"withdrawal"===e.type?"Cekme":e.type||"",e.category||"",e.description||"","cash"===e.accountType?"Kasa":"bank"===e.accountType?"Banka":e.accountType||"",e.amount||0,e.reference||""]),r=ed.utils.aoa_to_sheet([["Tarih","Tip","Kategori","Aciklama","Hesap","Tutar","Referans"],...i]);ed.utils.book_append_sheet(a,r,"Islemler");let n=c.map(e=>[e.name||"",e.bankName||"",e.iban||"",e.branch||"",e.currency||"EUR",e.balance||0,!1!==e.isActive?"Aktif":"Pasif"]),d=ed.utils.aoa_to_sheet([["Hesap Adi","Banka","IBAN","Sube","Para Birimi","Bakiye","Durum"],...n]);ed.utils.book_append_sheet(a,d,"Banka Hesaplari");let o=x.map(e=>[e.bankName||"",e.creditType||"",e.amount||0,e.paidAmount||0,e.remainingAmount||0,e.interestRate||0,e.monthlyPayment||0,e.term||0,e.startDate||"",e.endDate||"","active"===e.status?"Aktif":"completed"===e.status?"Tamamlandi":e.status||""]),h=ed.utils.aoa_to_sheet([["Banka","Kredi Turu","Toplam","Odenen","Kalan","Faiz %","Taksit","Vade (Ay)","Baslangic","Bitis","Durum"],...o]);ed.utils.book_append_sheet(a,h,"Krediler");let g=u.map(e=>{let a=x.find(a=>a.id===e.creditId);return[a?.bankName||"",e.paymentNumber||"",e.dueDate||"",e.paidDate||"",e.amount||0,e.principal||0,e.interest||0,"paid"===e.status?"Odendi":"pending"===e.status?"Bekliyor":e.status||""]}),p=ed.utils.aoa_to_sheet([["Kredi","Taksit No","Vade","Odeme Tarihi","Tutar","Anapara","Faiz","Durum"],...g]);ed.utils.book_append_sheet(a,p,"Kredi Odemeleri");let j=m.map(e=>[e.date||e.openedAt?.split("T")[0]||"",e.openingBalance||0,e.closingBalance||0,e.expectedBalance||0,(e.closingBalance||0)-(e.expectedBalance||0),"open"===e.status?"Acik":"Kapali",e.openedBy||"",e.closedBy||""]),b=ed.utils.aoa_to_sheet([["Tarih","Acilis","Kapanis","Beklenen","Fark","Durum","Acan","Kapatan"],...j]);ed.utils.book_append_sheet(a,b,"Kasa Kayitlari");let N=ed.write(a,{bookType:"xlsx",type:"array"}),v=new Blob([N],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,em.saveAs)(v,`Mali_Musavir_Raporu_${e_}_${eY}.xlsx`),R.toast.success("Mali Musavir raporu indirildi!")}catch(e){R.toast.error("Export hatasi: "+e.message)}};return(0,a.jsxs)("div",{className:"h-full flex flex-col bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white border-b px-8 py-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Finans Yonetimi"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Kasa, banka, kredi ve hazine yonetimi"})]}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsxs)(t.Button,{variant:"outline",size:"sm",onClick:()=>{N(!0),setTimeout(()=>N(!1),500)},disabled:b,children:[(0,a.jsx)(L.RefreshCw,{className:`h-4 w-4 mr-2 ${b?"animate-spin":""}`}),"Yenile"]})})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-auto p-8",children:(0,a.jsxs)(w.Tabs,{defaultValue:"dashboard",className:"w-full",children:[(0,a.jsxs)(w.TabsList,{className:"grid w-full grid-cols-8 mb-6",children:[(0,a.jsxs)(w.TabsTrigger,{value:"dashboard",children:[(0,a.jsx)(z.TrendingUp,{className:"h-4 w-4 mr-2"}),"Hazine Ozeti"]}),(0,a.jsxs)(w.TabsTrigger,{value:"branches",children:[(0,a.jsx)(es.Store,{className:"h-4 w-4 mr-2"}),"Sube Kasalari"]}),(0,a.jsxs)(w.TabsTrigger,{value:"kdv",children:[(0,a.jsx)(ei.Percent,{className:"h-4 w-4 mr-2"}),"DDV Raporu"]}),(0,a.jsxs)(w.TabsTrigger,{value:"cash",children:[(0,a.jsx)(M.Wallet,{className:"h-4 w-4 mr-2"}),"Kasa"]}),(0,a.jsxs)(w.TabsTrigger,{value:"bank",children:[(0,a.jsx)(O.Building2,{className:"h-4 w-4 mr-2"}),"Banka"]}),(0,a.jsxs)(w.TabsTrigger,{value:"credits",children:[(0,a.jsx)(E.CreditCard,{className:"h-4 w-4 mr-2"}),"Krediler"]}),(0,a.jsxs)(w.TabsTrigger,{value:"transactions",children:[(0,a.jsx)(J.Receipt,{className:"h-4 w-4 mr-2"}),"Islemler"]}),(0,a.jsxs)(w.TabsTrigger,{value:"export",children:[(0,a.jsx)(H.FileSpreadsheet,{className:"h-4 w-4 mr-2"}),"Export"]})]}),(0,a.jsxs)(w.TabsContent,{value:"dashboard",children:[(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-4 mb-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-green-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(M.Wallet,{className:"h-5 w-5 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Kasa"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-green-600",children:["â‚¬",ao.cashBalance.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-amber-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-amber-100 rounded-lg",children:(0,a.jsx)(O.Building2,{className:"h-5 w-5 text-amber-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Banka"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-amber-600",children:["â‚¬",ao.bankBalance.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-purple-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)(q,{className:"h-5 w-5 text-purple-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Toplam Varlik"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-purple-600",children:["â‚¬",ao.totalAssets.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-red-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-red-100 rounded-lg",children:(0,a.jsx)(E.CreditCard,{className:"h-5 w-5 text-red-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Kredi Borcu"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-red-600",children:["â‚¬",ao.totalCreditDebt.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-amber-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-amber-100 rounded-lg",children:(0,a.jsx)($.DollarSign,{className:"h-5 w-5 text-amber-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Net Deger"}),(0,a.jsxs)("p",{className:`text-xl font-semibold ${ao.netWorth>=0?"text-green-600":"text-red-600"}`,children:["â‚¬",ao.netWorth.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg border",children:[(0,a.jsxs)("div",{className:"p-4 border-b flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)(O.Building2,{className:"h-5 w-5 text-amber-600"}),"Banka Hesaplari"]}),(0,a.jsxs)(t.Button,{variant:"ghost",size:"sm",onClick:()=>e0(!0),children:["Tumu ",(0,a.jsx)(Z.ChevronRight,{className:"h-4 w-4 ml-1"})]})]}),(0,a.jsx)("div",{className:"p-4",children:0===c.length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Henuz banka hesabi yok"}):(0,a.jsx)("div",{className:"space-y-3",children:c.slice(0,4).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.bankName})]}),(0,a.jsxs)("p",{className:"font-semibold text-amber-600",children:["â‚¬",(e.balance||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]},e.id))})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border",children:[(0,a.jsx)("div",{className:"p-4 border-b flex items-center justify-between",children:(0,a.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)(E.CreditCard,{className:"h-5 w-5 text-red-600"}),"Aktif Krediler (",ao.activeCredits,")"]})}),(0,a.jsx)("div",{className:"p-4",children:0===x.filter(e=>"active"===e.status).length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Aktif kredi yok"}):(0,a.jsx)("div",{className:"space-y-3",children:x.filter(e=>"active"===e.status).slice(0,4).map(e=>(0,a.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"font-medium",children:e.bankName}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.creditType})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-600",children:["Kalan: â‚¬",(e.remainingAmount||0).toLocaleString("tr-TR")]}),(0,a.jsxs)("span",{className:"text-gray-600",children:["Taksit: â‚¬",(e.monthlyPayment||0).toLocaleString("tr-TR")]})]}),(0,a.jsx)(A.Progress,{value:(e.paidAmount||0)/(e.amount||1)*100,className:"mt-2 h-2"})]},e.id))})})]})]}),(0,a.jsxs)("div",{className:"mt-6 bg-white rounded-lg border",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)(ee.Clock,{className:"h-5 w-5 text-gray-600"}),"Bugunun Aktivitesi"]})}),(0,a.jsxs)("div",{className:"p-4 grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,a.jsx)(U,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Girisler"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["â‚¬",ao.todayIncome.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[(0,a.jsx)(_,{className:"h-8 w-8 text-red-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Cikislar"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-red-600",children:["â‚¬",ao.todayExpense.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-amber-50 rounded-lg",children:[(0,a.jsx)($.DollarSign,{className:"h-8 w-8 text-amber-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Net"}),(0,a.jsxs)("p",{className:`text-2xl font-bold ${ao.todayIncome-ao.todayExpense>=0?"text-green-600":"text-red-600"}`,children:["â‚¬",(ao.todayIncome-ao.todayExpense).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})]})]}),(0,a.jsxs)(w.TabsContent,{value:"branches",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-purple-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)(es.Store,{className:"h-5 w-5 text-purple-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Toplam Sube"}),(0,a.jsx)("p",{className:"text-xl font-semibold",children:ah.activeBranches})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-green-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(el,{className:"h-5 w-5 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Acik Kasalar"}),(0,a.jsx)("p",{className:"text-xl font-semibold text-green-600",children:ah.openCashRegisters})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-orange-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,a.jsx)(M.Wallet,{className:"h-5 w-5 text-orange-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Toplam Kasa"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-orange-600",children:["â‚¬",ah.totalBranchCash.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-amber-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-amber-100 rounded-lg",children:(0,a.jsx)(O.Building2,{className:"h-5 w-5 text-amber-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Toplam Banka"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-amber-600",children:["â‚¬",ah.totalBranchBankBalance.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)(es.Store,{className:"h-5 w-5"}),"Sube Kasa Durumlari"]})}),v?(0,a.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,a.jsx)(L.RefreshCw,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),"Subeler yukleniyor..."]}):0===p.length?(0,a.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,a.jsx)(es.Store,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),(0,a.jsx)("p",{children:"Henuz sube bulunamadi"}),(0,a.jsx)("p",{className:"text-sm mt-2",children:"Desktop uygulamasinda subeler tanimlanmalidir"})]}):(0,a.jsx)("div",{className:"divide-y",children:p.filter(e=>!1!==e.isActive).map(e=>{let s=e.treasury?.cashRegister,t=s?.audit?.status==="open",l=s?.balance?.currentBalance||0,i=Object.entries(e.treasury?.bankAccounts||{}).map(([e,a])=>({id:e,...a})),r=i.reduce((e,a)=>e+(a.balance?.currentBalance||0),0);return(0,a.jsxs)("div",{className:"p-4 hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:`p-2 rounded-full ${t?"bg-green-100":"bg-gray-100"}`,children:t?(0,a.jsx)(el,{className:"h-5 w-5 text-green-600"}):(0,a.jsx)(et.Lock,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium",children:e.name||e.id}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:t?(0,a.jsxs)(a.Fragment,{children:["Acik - ",s?.audit?.openedAt?new Date(s.audit.openedAt).toLocaleString("tr-TR"):"-"]}):"Kapali"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Kasa"}),(0,a.jsxs)("p",{className:`text-lg font-semibold ${l>0?"text-green-600":"text-gray-600"}`,children:["â‚¬",l.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Banka (",i.length,")"]}),(0,a.jsxs)("p",{className:`text-lg font-semibold ${r>0?"text-amber-600":"text-gray-600"}`,children:["â‚¬",r.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),(0,a.jsxs)("div",{className:"text-right border-l pl-4",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Toplam"}),(0,a.jsxs)("p",{className:"text-lg font-bold",children:["â‚¬",(l+r).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})]}),i.length>0&&(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Banka Hesaplari:"}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-2",children:i.map(e=>{let s="credit_line"===e.accountType||"leasing"===e.accountType,t=e.balance?.currentBalance||0;return(0,a.jsxs)("div",{className:`p-2 rounded-lg text-sm ${s?"bg-red-50":"bg-amber-50"}`,children:[(0,a.jsx)("p",{className:"font-medium truncate",children:e.accountName||e.bankName}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.bankName}),(0,a.jsxs)("p",{className:`font-semibold ${s?"text-red-600":t>=0?"text-amber-600":"text-red-600"}`,children:[e.currency||"EUR"," ",t.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),s&&e.creditLimit&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Limit: ",e.currency||"EUR"," ",(e.creditLimit||0).toLocaleString()]}),"leasing"===e.accountType&&e.leasingAsset&&(0,a.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.leasingAsset})]},e.id)})})]})]},e.id)})})]})]}),(0,a.jsxs)(w.TabsContent,{value:"kdv",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border mb-6 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(i.Label,{className:"font-semibold",children:"Donem:"}),(0,a.jsx)(l.Input,{type:"date",value:eh,onChange:e=>ej(e.target.value),className:"w-40"}),(0,a.jsx)("span",{className:"text-gray-400",children:"â€”"}),(0,a.jsx)(l.Input,{type:"date",value:eb,onChange:e=>eN(e.target.value),className:"w-40"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(S,{id:"distribution",checked:eT,onCheckedChange:ek}),(0,a.jsx)(i.Label,{htmlFor:"distribution",className:"text-sm cursor-pointer",children:"Masraf Dagitimi"})]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"DDV = Satis DDV - Alis DDV - Masraf DDV"})]})]})}),eT&&(0,a.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 mb-6",children:[(0,a.jsxs)("h4",{className:"font-medium text-purple-800 mb-2 flex items-center gap-2",children:[(0,a.jsx)(X.Calculator,{className:"h-4 w-4"}),"Masraf Dagitimi Aktif"]}),(0,a.jsxs)("p",{className:"text-sm text-purple-700 mb-3",children:["Genel giderler (â‚¬",au.distribution.genelExpenses.toLocaleString("tr-TR",{minimumFractionDigits:2}),") ve alislar satis oranina gore subelere dagitildi."]}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-2 text-xs",children:Object.entries(au.distribution.salesRatios).map(([e,s])=>(0,a.jsxs)("div",{className:"bg-white rounded p-2 text-center",children:[(0,a.jsxs)("span",{className:"font-medium",children:[eI[e]?.icon," ",eI[e]?.name]}),(0,a.jsxs)("div",{className:"text-purple-600 font-bold",children:[(100*s).toFixed(1),"%"]})]},e))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-green-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(er.ShoppingCart,{className:"h-5 w-5 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Satis DDV"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-green-600",children:["â‚¬",au.totals.salesVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:["Satis: â‚¬",au.totals.salesAmount.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-blue-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(en.Package,{className:"h-5 w-5 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Alis DDV"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-blue-600",children:["â‚¬",au.totals.purchaseVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:["Alis: â‚¬",au.totals.purchaseAmount.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border-l-4 border-l-orange-500 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,a.jsx)(J.Receipt,{className:"h-5 w-5 text-orange-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Masraf DDV"}),(0,a.jsxs)("p",{className:"text-xl font-semibold text-orange-600",children:["â‚¬",au.totals.expenseVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:["Masraf: â‚¬",au.totals.expenseAmount.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})}),(0,a.jsx)("div",{className:`bg-white rounded-lg border-l-4 p-4 ${au.totals.netVat>=0?"border-l-red-500":"border-l-green-500"}`,children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:`p-2 rounded-lg ${au.totals.netVat>=0?"bg-red-100":"bg-green-100"}`,children:(0,a.jsx)(ec,{className:`h-5 w-5 ${au.totals.netVat>=0?"text-red-600":"text-green-600"}`})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Net DDV"}),(0,a.jsxs)("p",{className:`text-xl font-semibold ${au.totals.netVat>=0?"text-red-600":"text-green-600"}`,children:["â‚¬",au.totals.netVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:au.totals.netVat>=0?"Odenmesi gereken":"Iade alinacak"})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)(ei.Percent,{className:"h-5 w-5"}),"Sube Bazli DDV Detayi"]})}),(0,a.jsxs)(D.Table,{children:[(0,a.jsx)(D.TableHeader,{children:(0,a.jsxs)(D.TableRow,{children:[(0,a.jsx)(D.TableHead,{children:"Sube"}),(0,a.jsx)(D.TableHead,{className:"text-right",children:"Satis"}),(0,a.jsx)(D.TableHead,{className:"text-right text-green-700",children:"Satis DDV"}),(0,a.jsx)(D.TableHead,{className:"text-right",children:"Alis"}),(0,a.jsx)(D.TableHead,{className:"text-right text-blue-700",children:"Alis DDV"}),(0,a.jsx)(D.TableHead,{className:"text-right",children:"Masraf"}),(0,a.jsx)(D.TableHead,{className:"text-right text-orange-700",children:"Masraf DDV"}),(0,a.jsx)(D.TableHead,{className:"text-right font-bold",children:"Net DDV"})]})}),(0,a.jsxs)(D.TableBody,{children:[au.branchSummary.map(e=>(0,a.jsxs)(D.TableRow,{children:[(0,a.jsx)(D.TableCell,{children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:`px-2 py-1 rounded text-xs ${e.color}`,children:[e.icon," ",e.branchName]})})}),(0,a.jsxs)(D.TableCell,{className:"text-right",children:["â‚¬",e.salesAmount.toLocaleString("tr-TR",{minimumFractionDigits:2}),(0,a.jsxs)("span",{className:"text-xs text-gray-400 ml-1",children:["(",e.salesCount,")"]})]}),(0,a.jsxs)(D.TableCell,{className:"text-right text-green-600 font-medium",children:["â‚¬",e.salesVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsx)(D.TableCell,{className:"text-right",children:"merkez"===e.branchId?(0,a.jsxs)(a.Fragment,{children:["â‚¬",e.purchaseAmount.toLocaleString("tr-TR",{minimumFractionDigits:2}),(0,a.jsxs)("span",{className:"text-xs text-gray-400 ml-1",children:["(",e.purchaseCount,")"]})]}):(0,a.jsx)("span",{className:"text-gray-300",children:"-"})}),(0,a.jsx)(D.TableCell,{className:"text-right text-blue-600 font-medium",children:"merkez"===e.branchId?(0,a.jsxs)(a.Fragment,{children:["â‚¬",e.purchaseVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]}):(0,a.jsx)("span",{className:"text-gray-300",children:"-"})}),(0,a.jsxs)(D.TableCell,{className:"text-right",children:["â‚¬",e.expenseAmount.toLocaleString("tr-TR",{minimumFractionDigits:2}),(0,a.jsxs)("span",{className:"text-xs text-gray-400 ml-1",children:["(",e.expenseCount,")"]})]}),(0,a.jsxs)(D.TableCell,{className:"text-right text-orange-600 font-medium",children:["â‚¬",e.expenseVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsxs)(D.TableCell,{className:`text-right font-bold ${e.netVat>=0?"text-red-600":"text-green-600"}`,children:["â‚¬",e.netVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]},e.branchId)),(0,a.jsxs)(D.TableRow,{className:"bg-gray-50 font-bold",children:[(0,a.jsx)(D.TableCell,{children:"TOPLAM"}),(0,a.jsxs)(D.TableCell,{className:"text-right",children:["â‚¬",au.totals.salesAmount.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsxs)(D.TableCell,{className:"text-right text-green-700",children:["â‚¬",au.totals.salesVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsxs)(D.TableCell,{className:"text-right",children:["â‚¬",au.totals.purchaseAmount.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsxs)(D.TableCell,{className:"text-right text-blue-700",children:["â‚¬",au.totals.purchaseVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsxs)(D.TableCell,{className:"text-right",children:["â‚¬",au.totals.expenseAmount.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsxs)(D.TableCell,{className:"text-right text-orange-700",children:["â‚¬",au.totals.expenseVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsxs)(D.TableCell,{className:`text-right ${au.totals.netVat>=0?"text-red-700":"text-green-700"}`,children:["â‚¬",au.totals.netVat.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})]})]}),(0,a.jsxs)("div",{className:"mt-6 p-4 bg-amber-50 rounded-lg border border-amber-200",children:[(0,a.jsx)("h4",{className:"font-medium text-amber-800 mb-2",children:"DDV Hesaplama Aciklamasi"}),(0,a.jsxs)("ul",{className:"text-sm text-amber-700 space-y-1",children:[(0,a.jsxs)("li",{children:["â€¢ ",(0,a.jsx)("strong",{children:"Satis DDV:"})," Musterilere yapilan satislardan tahsil edilen DDV"]}),(0,a.jsxs)("li",{children:["â€¢ ",(0,a.jsx)("strong",{children:"Alis DDV:"})," Tedarikicilerden yapilan alislardan odenen DDV (Tum alislar Merkez Depo'ya)"]}),(0,a.jsxs)("li",{children:["â€¢ ",(0,a.jsx)("strong",{children:"Masraf DDV:"})," Isletme giderlerinden odenen DDV (sube bazli)"]}),(0,a.jsxs)("li",{children:["â€¢ ",(0,a.jsx)("strong",{children:"Net DDV:"})," Satis DDV - Alis DDV - Masraf DDV = Devlete odenmesi/iade alinmasi gereken tutar"]}),(0,a.jsxs)("li",{className:"pt-2 text-amber-600",children:[(0,a.jsx)("strong",{children:"Not:"})," Pozitif deger = Odenmesi gereken | Negatif deger = Iade alinacak"]})]})]})]}),(0,a.jsxs)(w.TabsContent,{value:"cash",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border mb-6 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(i.Label,{className:"font-semibold",children:"Sube Sec:"}),(0,a.jsxs)(r.Select,{value:eS,onValueChange:ew,children:[(0,a.jsx)(r.SelectTrigger,{className:"w-64",children:(0,a.jsx)(r.SelectValue,{placeholder:"Sube secin..."})}),(0,a.jsx)(r.SelectContent,{children:p.filter(e=>e.id&&!1!==e.isActive).map(e=>(0,a.jsx)(r.SelectItem,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(es.Store,{className:"h-4 w-4"}),e.name,e.treasury?.cashRegister?.audit?.status==="open"&&(0,a.jsx)("span",{className:"text-xs bg-green-100 text-green-700 px-1.5 py-0.5 rounded",children:"Acik"})]})},e.id))})]})]})}),eS?(()=>{let e=p.find(e=>e.id===eS);if(!e)return null;let s=e.treasury?.cashRegister,t=s?.audit?.status==="open",l=s?.balance?.currentBalance||0;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border mb-6",children:(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:`p-4 rounded-full ${t?"bg-green-100":"bg-gray-100"}`,children:(0,a.jsx)(M.Wallet,{className:`h-8 w-8 ${t?"text-green-600":"text-gray-400"}`})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold",children:[e.name," - Kasa"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:t?`Acilis: ${s?.audit?.openedAt?new Date(s.audit.openedAt).toLocaleString("tr-TR"):"-"}`:"Kasa kapali"}),t&&s?.audit?.openedBy&&(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:["Acan: ",s.audit.openedBy]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Guncel Bakiye"}),(0,a.jsxs)("p",{className:`text-3xl font-bold ${l>=0?"text-green-600":"text-red-600"}`,children:["â‚¬",l.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),s?.balance?.openingBalance!==void 0&&(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:["Acilis: â‚¬",(s.balance.openingBalance||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})})}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Acilis Bakiyesi"}),(0,a.jsxs)("p",{className:"text-xl font-semibold",children:["â‚¬",(s?.balance?.openingBalance||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Beklenen Bakiye"}),(0,a.jsxs)("p",{className:"text-xl font-semibold",children:["â‚¬",(s?.balance?.expectedBalance||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Fark"}),(0,a.jsxs)("p",{className:`text-xl font-semibold ${(s?.balance?.currentBalance||0)-(s?.balance?.expectedBalance||0)==0?"text-green-600":"text-red-600"}`,children:["â‚¬",((s?.balance?.currentBalance||0)-(s?.balance?.expectedBalance||0)).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]}),s?.balance?.lastUpdate&&(0,a.jsxs)("div",{className:"text-sm text-gray-500 mb-4",children:["Son guncelleme: ",new Date(s.balance.lastUpdate).toLocaleString("tr-TR")]})]})})():(0,a.jsxs)("div",{className:"bg-white rounded-lg border p-8 text-center text-gray-500",children:[(0,a.jsx)(es.Store,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"Kasa bilgilerini gormek icin bir sube secin"})]}),eS&&(0,a.jsxs)("div",{className:"bg-white rounded-lg border",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)("h3",{className:"font-semibold",children:["Kasa Islemleri - ",p.find(e=>e.id===eS)?.name]})}),(0,a.jsxs)(D.Table,{children:[(0,a.jsx)(D.TableHeader,{children:(0,a.jsxs)(D.TableRow,{children:[(0,a.jsx)(D.TableHead,{children:"Tarih"}),(0,a.jsx)(D.TableHead,{children:"Tip"}),(0,a.jsx)(D.TableHead,{children:"Aciklama"}),(0,a.jsx)(D.TableHead,{children:"Kategori"}),(0,a.jsx)(D.TableHead,{className:"text-right",children:"Tutar"})]})}),(0,a.jsxs)(D.TableBody,{children:[e.filter(e=>"cash"===e.accountType&&e.branch===eS).slice(0,20).map(e=>(0,a.jsxs)(D.TableRow,{children:[(0,a.jsx)(D.TableCell,{children:e.date||e.createdAt?.split("T")[0]}),(0,a.jsx)(D.TableCell,{children:(0,a.jsx)(eR,{type:e.type||""})}),(0,a.jsx)(D.TableCell,{children:e.description}),(0,a.jsx)(D.TableCell,{children:e.category}),(0,a.jsxs)(D.TableCell,{className:`text-right font-medium ${"income"===e.type?"text-green-600":"text-red-600"}`,children:["income"===e.type?"+":"-","â‚¬",(e.amount||0).toLocaleString("tr-TR")]})]},e.id)),0===e.filter(e=>"cash"===e.accountType&&e.branch===eS).length&&(0,a.jsx)(D.TableRow,{children:(0,a.jsx)(D.TableCell,{colSpan:5,className:"text-center py-8 text-gray-500",children:"Bu subeye ait kasa islemi bulunamadi"})})]})]})]})]}),(0,a.jsxs)(w.TabsContent,{value:"bank",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border mb-6 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(i.Label,{className:"font-semibold",children:"Sube Sec:"}),(0,a.jsxs)(r.Select,{value:eL,onValueChange:eF,children:[(0,a.jsx)(r.SelectTrigger,{className:"w-64",children:(0,a.jsx)(r.SelectValue,{placeholder:"Sube secin..."})}),(0,a.jsx)(r.SelectContent,{children:p.filter(e=>e.id&&!1!==e.isActive).map(e=>{let s=e.treasury?.bankAccounts,t=s?Object.keys(s).length:0;return(0,a.jsx)(r.SelectItem,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(es.Store,{className:"h-4 w-4"}),e.name,(0,a.jsxs)("span",{className:"text-xs bg-amber-100 text-amber-700 px-1.5 py-0.5 rounded",children:[t," hesap"]})]})},e.id)})})]})]})}),eL?(()=>{let s=p.find(e=>e.id===eL);if(!s)return null;let t=Object.entries(s.treasury?.bankAccounts||{}).map(([e,a])=>({id:e,...a})),l=t.reduce((e,a)=>e+(a.balance?.currentBalance||0),0);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border mb-6 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"p-4 rounded-full bg-amber-100",children:(0,a.jsx)(O.Building2,{className:"h-8 w-8 text-amber-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold",children:[s.name," - Banka Hesaplari"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[t.length," hesap"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Toplam Bakiye"}),(0,a.jsxs)("p",{className:`text-3xl font-bold ${l>=0?"text-amber-600":"text-red-600"}`,children:["â‚¬",l.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[t.map(e=>{let s="credit_line"===e.accountType||"leasing"===e.accountType,t=e.balance?.currentBalance||0;return(0,a.jsxs)("div",{className:`bg-white rounded-lg border p-4 ${s?"border-red-200":""}`,children:[(0,a.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:e.accountName||e.bankName}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.bankName}),e.accountType&&(0,a.jsx)("span",{className:`text-xs px-2 py-0.5 rounded mt-1 inline-block ${s?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:"checking"===e.accountType?"Vadesiz":"savings"===e.accountType?"Vadeli":"foreign"===e.accountType?"Doviz":"business"===e.accountType?"Ticari":"credit_line"===e.accountType?"Kredi":"leasing"===e.accountType?"Leasing":e.accountType})]})}),e.iban&&(0,a.jsx)("p",{className:"text-xs text-gray-400 mb-2 font-mono",children:e.iban}),(0,a.jsxs)("p",{className:`text-2xl font-bold ${s?"text-red-600":t>=0?"text-amber-600":"text-red-600"}`,children:[e.currency||"EUR"," ",t.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),s&&e.creditLimit&&(0,a.jsxs)("div",{className:"mt-2 text-sm",children:[(0,a.jsxs)("p",{className:"text-gray-500",children:["Limit: ",e.currency||"EUR"," ",(e.creditLimit||0).toLocaleString()]}),(0,a.jsxs)("p",{className:"text-gray-500",children:["Kullanilan: ",e.currency||"EUR"," ",(e.usedAmount||0).toLocaleString()]})]}),"leasing"===e.accountType&&e.leasingAsset&&(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:e.leasingAsset}),e.balance?.lastUpdated&&(0,a.jsxs)("p",{className:"mt-2 text-xs text-gray-400",children:["Son: ",new Date(e.balance.lastUpdated).toLocaleDateString("tr-TR")]})]},e.id)}),0===t.length&&(0,a.jsxs)("div",{className:"col-span-2 bg-white rounded-lg border p-8 text-center",children:[(0,a.jsx)(O.Building2,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Bu subede banka hesabi bulunamadi"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)("h3",{className:"font-semibold",children:["Banka Islemleri - ",s.name]})}),(0,a.jsxs)(D.Table,{children:[(0,a.jsx)(D.TableHeader,{children:(0,a.jsxs)(D.TableRow,{children:[(0,a.jsx)(D.TableHead,{children:"Tarih"}),(0,a.jsx)(D.TableHead,{children:"Tip"}),(0,a.jsx)(D.TableHead,{children:"Hesap"}),(0,a.jsx)(D.TableHead,{children:"Aciklama"}),(0,a.jsx)(D.TableHead,{className:"text-right",children:"Tutar"})]})}),(0,a.jsxs)(D.TableBody,{children:[e.filter(e=>"bank"===e.accountType&&e.branch===eL).slice(0,20).map(e=>(0,a.jsxs)(D.TableRow,{children:[(0,a.jsx)(D.TableCell,{children:e.date||e.createdAt?.split("T")[0]}),(0,a.jsx)(D.TableCell,{children:(0,a.jsx)(eR,{type:e.type||""})}),(0,a.jsx)(D.TableCell,{children:t.find(a=>a.id===e.accountId)?.accountName||t.find(a=>a.id===e.accountId)?.bankName||e.accountId||"-"}),(0,a.jsx)(D.TableCell,{children:e.description}),(0,a.jsxs)(D.TableCell,{className:`text-right font-medium ${"deposit"===e.type||"income"===e.type?"text-green-600":"text-red-600"}`,children:["deposit"===e.type||"income"===e.type?"+":"-","â‚¬",(e.amount||0).toLocaleString("tr-TR")]})]},e.id)),0===e.filter(e=>"bank"===e.accountType&&e.branch===eL).length&&(0,a.jsx)(D.TableRow,{children:(0,a.jsx)(D.TableCell,{colSpan:5,className:"text-center py-8 text-gray-500",children:"Bu subeye ait banka islemi bulunamadi"})})]})]})]})]})})():(0,a.jsxs)("div",{className:"bg-white rounded-lg border p-8 text-center text-gray-500",children:[(0,a.jsx)(O.Building2,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"Banka bilgilerini gormek icin bir sube secin"})]})]}),(0,a.jsxs)(w.TabsContent,{value:"credits",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border mb-6 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"p-4 rounded-full bg-red-100",children:(0,a.jsx)(E.CreditCard,{className:"h-8 w-8 text-red-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Toplam Kredi Borcu"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[ao.activeCredits," aktif kredi"]})]})]}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-red-600",children:["â‚¬",ao.totalCreditDebt.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("div",{className:"flex gap-4",children:(0,a.jsxs)(t.Button,{onClick:()=>{ac(null),as(!0)},children:[(0,a.jsx)(B.Plus,{className:"h-4 w-4 mr-2"}),"Yeni Kredi"]})}),(0,a.jsxs)(r.Select,{value:eP,onValueChange:eU,children:[(0,a.jsx)(r.SelectTrigger,{className:"w-[180px]",children:(0,a.jsx)(r.SelectValue,{placeholder:"Durum"})}),(0,a.jsxs)(r.SelectContent,{children:[(0,a.jsx)(r.SelectItem,{value:"all",children:"Tum Krediler"}),(0,a.jsx)(r.SelectItem,{value:"active",children:"Aktif"}),(0,a.jsx)(r.SelectItem,{value:"completed",children:"Tamamlandi"})]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg border",children:(0,a.jsxs)(D.Table,{children:[(0,a.jsx)(D.TableHeader,{children:(0,a.jsxs)(D.TableRow,{children:[(0,a.jsx)(D.TableHead,{children:"Banka"}),(0,a.jsx)(D.TableHead,{children:"Kredi Tipi"}),(0,a.jsx)(D.TableHead,{children:"Toplam"}),(0,a.jsx)(D.TableHead,{children:"Kalan"}),(0,a.jsx)(D.TableHead,{children:"Taksit"}),(0,a.jsx)(D.TableHead,{children:"Faiz"}),(0,a.jsx)(D.TableHead,{children:"Ilerleme"}),(0,a.jsx)(D.TableHead,{children:"Durum"}),(0,a.jsx)(D.TableHead,{className:"w-[60px]"})]})}),(0,a.jsxs)(D.TableBody,{children:[am.map(e=>{let s=(e.paidAmount||0)/(e.amount||1)*100;return(0,a.jsxs)(D.TableRow,{children:[(0,a.jsx)(D.TableCell,{className:"font-medium",children:e.bankName}),(0,a.jsx)(D.TableCell,{children:e.creditType}),(0,a.jsxs)(D.TableCell,{children:["â‚¬",(e.amount||0).toLocaleString("tr-TR")]}),(0,a.jsxs)(D.TableCell,{className:"text-red-600 font-medium",children:["â‚¬",(e.remainingAmount||0).toLocaleString("tr-TR")]}),(0,a.jsxs)(D.TableCell,{children:["â‚¬",(e.monthlyPayment||0).toLocaleString("tr-TR")]}),(0,a.jsxs)(D.TableCell,{children:["%",e.interestRate]}),(0,a.jsx)(D.TableCell,{className:"w-[120px]",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(A.Progress,{value:s,className:"h-2 flex-1"}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:[Math.round(s),"%"]})]})}),(0,a.jsx)(D.TableCell,{children:(0,a.jsx)(eB,{status:e.status||"active"})}),(0,a.jsx)(D.TableCell,{children:(0,a.jsxs)(C.DropdownMenu,{children:[(0,a.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(t.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(F.MoreHorizontal,{className:"h-4 w-4"})})}),(0,a.jsxs)(C.DropdownMenuContent,{align:"end",children:[(0,a.jsxs)(C.DropdownMenuItem,{onClick:()=>{ac(e),al(!0)},children:[(0,a.jsx)(G.Eye,{className:"h-4 w-4 mr-2"})," Detay"]}),(0,a.jsxs)(C.DropdownMenuItem,{onClick:()=>{ac(e),ar(!0)},children:[(0,a.jsx)(J.Receipt,{className:"h-4 w-4 mr-2"})," Taksit Ode"]}),(0,a.jsxs)(C.DropdownMenuItem,{onClick:()=>{ac(e),as(!0)},children:[(0,a.jsx)(Y.Edit,{className:"h-4 w-4 mr-2"})," Duzenle"]}),(0,a.jsxs)(C.DropdownMenuItem,{className:"text-red-600",onClick:()=>ap(e),children:[(0,a.jsx)(W.Trash2,{className:"h-4 w-4 mr-2"})," Sil"]})]})]})})]},e.id)}),0===am.length&&(0,a.jsx)(D.TableRow,{children:(0,a.jsx)(D.TableCell,{colSpan:9,className:"text-center py-8 text-gray-500",children:"all"!==eP?"Bu durumda kredi yok":"Henuz kredi eklenmemis"})})]})]})})]}),(0,a.jsxs)(w.TabsContent,{value:"transactions",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(K.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)(l.Input,{placeholder:"Islem ara...",value:eK,onChange:e=>eV(e.target.value),className:"pl-10"})]}),(0,a.jsx)(l.Input,{type:"date",value:ez,onChange:e=>e$(e.target.value),className:"w-[180px]"}),(0,a.jsxs)(r.Select,{value:eH,onValueChange:eM,children:[(0,a.jsx)(r.SelectTrigger,{className:"w-[150px]",children:(0,a.jsx)(r.SelectValue,{placeholder:"Tip"})}),(0,a.jsxs)(r.SelectContent,{children:[(0,a.jsx)(r.SelectItem,{value:"all",children:"Tum tipler"}),(0,a.jsx)(r.SelectItem,{value:"income",children:"Giris"}),(0,a.jsx)(r.SelectItem,{value:"expense",children:"Cikis"}),(0,a.jsx)(r.SelectItem,{value:"deposit",children:"Yatirma"}),(0,a.jsx)(r.SelectItem,{value:"withdrawal",children:"Cekme"}),(0,a.jsx)(r.SelectItem,{value:"transfer",children:"Transfer"})]})]}),(0,a.jsxs)(r.Select,{value:eO,onValueChange:eE,children:[(0,a.jsx)(r.SelectTrigger,{className:"w-[150px]",children:(0,a.jsx)(r.SelectValue,{placeholder:"Hesap"})}),(0,a.jsxs)(r.SelectContent,{children:[(0,a.jsx)(r.SelectItem,{value:"all",children:"Tum hesaplar"}),(0,a.jsx)(r.SelectItem,{value:"cash",children:"Kasa"}),(0,a.jsx)(r.SelectItem,{value:"bank",children:"Banka"})]})]}),(0,a.jsxs)(t.Button,{variant:"outline",onClick:ab,children:[(0,a.jsx)(V.Download,{className:"h-4 w-4 mr-2"}),"Excel"]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg border",children:(0,a.jsxs)(D.Table,{children:[(0,a.jsx)(D.TableHeader,{children:(0,a.jsxs)(D.TableRow,{children:[(0,a.jsx)(D.TableHead,{children:"Tarih"}),(0,a.jsx)(D.TableHead,{children:"Tip"}),(0,a.jsx)(D.TableHead,{children:"Aciklama"}),(0,a.jsx)(D.TableHead,{children:"Kategori"}),(0,a.jsx)(D.TableHead,{children:"Hesap"}),(0,a.jsx)(D.TableHead,{className:"text-right",children:"Tutar"}),(0,a.jsx)(D.TableHead,{className:"w-[60px]"})]})}),(0,a.jsx)(D.TableBody,{children:b?(0,a.jsx)(D.TableRow,{children:(0,a.jsx)(D.TableCell,{colSpan:7,className:"text-center py-8 text-gray-500",children:"Yukleniyor..."})}):0===ad.length?(0,a.jsx)(D.TableRow,{children:(0,a.jsx)(D.TableCell,{colSpan:7,className:"text-center py-8 text-gray-500",children:eK||"all"!==eH||"all"!==eO||ez?"Filtrelere uygun islem bulunamadi":"Henuz islem eklenmemis"})}):ad.slice(0,50).map(e=>(0,a.jsxs)(D.TableRow,{className:"hover:bg-gray-50",children:[(0,a.jsx)(D.TableCell,{className:"font-medium",children:e.date||e.createdAt?.split("T")[0]||"-"}),(0,a.jsx)(D.TableCell,{children:(0,a.jsx)(eR,{type:e.type||"other"})}),(0,a.jsx)(D.TableCell,{children:e.description||"-"}),(0,a.jsx)(D.TableCell,{className:"text-gray-600",children:e.category||"-"}),(0,a.jsx)(D.TableCell,{className:"text-gray-600",children:"cash"===e.accountType?"ðŸ’µ Kasa":"bank"===e.accountType?"ðŸ¦ Banka":e.accountType||"-"}),(0,a.jsxs)(D.TableCell,{className:`text-right font-medium ${["income","deposit"].includes(e.type||"")?"text-green-600":"text-red-600"}`,children:[["income","deposit"].includes(e.type||"")?"+":"-","â‚¬",(e.amount||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,a.jsx)(D.TableCell,{children:(0,a.jsxs)(C.DropdownMenu,{children:[(0,a.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(t.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(F.MoreHorizontal,{className:"h-4 w-4"})})}),(0,a.jsxs)(C.DropdownMenuContent,{align:"end",children:[(0,a.jsxs)(C.DropdownMenuItem,{onClick:()=>{R.toast.info(`Tarih: ${e.date||e.createdAt?.split("T")[0]}
Tip: ${e.type}
Tutar: â‚¬${e.amount}
Aciklama: ${e.description||"-"}
Kategori: ${e.category||"-"}
Referans: ${e.reference||"-"}`)},children:[(0,a.jsx)(G.Eye,{className:"h-4 w-4 mr-2"})," Detaylar"]}),(0,a.jsxs)(C.DropdownMenuItem,{className:"text-red-600",onClick:()=>aj(e),children:[(0,a.jsx)(W.Trash2,{className:"h-4 w-4 mr-2"})," Sil"]})]})]})})]},e.id))})]})})]}),(0,a.jsx)(w.TabsContent,{value:"export",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg border p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:(0,a.jsx)(H.FileSpreadsheet,{className:"h-8 w-8 text-green-600"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Mali Musavir Raporu"}),(0,a.jsx)("p",{className:"text-gray-500 mt-2",children:"Tum finansal verilerinizi tek bir Excel dosyasinda indirin"})]}),(0,a.jsxs)("div",{className:"max-w-xl mx-auto mb-8",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rapor Donemi"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Baslangic"}),(0,a.jsx)(l.Input,{type:"date",value:e_,onChange:e=>eG(e.target.value)})]}),(0,a.jsx)("span",{className:"text-gray-400 mt-5",children:"â€”"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Bitis"}),(0,a.jsx)(l.Input,{type:"date",value:eY,onChange:e=>eW(e.target.value)})]})]})]}),(0,a.jsxs)("div",{className:"max-w-2xl mx-auto mb-8",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Rapor Icerigi (6 Sayfa)"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)(Q.CheckCircle,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm",children:"Ozet - Hazine durumu ve donem ozeti"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)(Q.CheckCircle,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm",children:"Islemler - Tum finansal hareketler"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)(Q.CheckCircle,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm",children:"Banka Hesaplari - Hesap detaylari"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)(Q.CheckCircle,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm",children:"Krediler - Kredi bilgileri"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)(Q.CheckCircle,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm",children:"Kredi Odemeleri - Taksit detaylari"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)(Q.CheckCircle,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm",children:"Kasa Kayitlari - Acilis/kapanis"})]})]})]}),(0,a.jsxs)("div",{className:"max-w-2xl mx-auto mb-8 p-4 bg-amber-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-amber-900 mb-3",children:"Mevcut Veriler"}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-amber-600",children:e.length}),(0,a.jsx)("p",{className:"text-xs text-amber-700",children:"Islem"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-amber-600",children:c.length}),(0,a.jsx)("p",{className:"text-xs text-amber-700",children:"Banka Hesabi"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-amber-600",children:x.length}),(0,a.jsx)("p",{className:"text-xs text-amber-700",children:"Kredi"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-amber-600",children:m.length}),(0,a.jsx)("p",{className:"text-xs text-amber-700",children:"Kasa Kaydi"})]})]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)(t.Button,{size:"lg",className:"px-12 py-6 text-lg bg-green-600 hover:bg-green-700",onClick:ab,children:[(0,a.jsx)(ea,{className:"h-6 w-6 mr-3"}),"Mali Musavir Raporunu Indir"]}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-3",children:"Excel formatinda (.xlsx) indirilecektir"})]})]})})]})}),(0,a.jsx)(eu,{open:eX,onOpenChange:eZ,account:e2}),(0,a.jsx)(eg,{open:eq,onOpenChange:eJ,accounts:c}),(0,a.jsx)(ep,{open:eQ,onOpenChange:e0,accounts:c,onEdit:e=>{e1(e),eZ(!0)},onDelete:ag}),(0,a.jsx)(ev,{open:e4,onOpenChange:e6}),(0,a.jsx)(ey,{open:e5,onOpenChange:e3,currentRegister:ax||null}),(0,a.jsx)(ef,{open:e8,onOpenChange:e7,type:e9}),(0,a.jsx)(eD,{open:aa,onOpenChange:as,credit:an,bankAccounts:c}),(0,a.jsx)(eC,{open:at,onOpenChange:al,credit:an,payments:u.filter(e=>e.creditId===an?.id)}),(0,a.jsx)(eA,{open:ai,onOpenChange:ar,credit:an,bankAccounts:c})]})}e.s(["default",()=>eL],57820)}]);